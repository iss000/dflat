AS65 Assembler for R6502 [1.42].                                     Page    1
---------------------------------- ppt3.asm ----------------------------------

-------------------------------- Symbol Table --------------------------------

              Symbol   Value        Decimal

                .bss : $8e67          36455
             ACOnOff : $8e71          36465
             ACrAmSl : $8e69          36457
             ACrEnSl : $8e6b          36459
             ACrNsSl : $8e6a          36458
             ACrTnSl : $8e6d          36461
             AddToEn : $8b42          35650
             AddToNs : $8ec3          36547
             AdInPtA : $89c9          35273
             AdInPtB : $8a8d          35469
             AdInPtC : $8aaf          35503
             AEnv_En : $8e7b          36475
              AFlags : $8e7c          36476
                Ampl : $8ece          36558   *
               AmplA : $0008              8   *
               AmplB : $0009              9   *
               AmplC : $000a             10   *
             ANNtSkp : $8e78          36472
               ANote : $8e79          36473
             ANtSkCn : $8e82          36482
             AOffOnD : $8e73          36467
             AOnOffD : $8e72          36466
             AOrnPtr : $8e74          36468
             APsInOr : $8e67          36455
             APsInSm : $8e68          36456
             ASamPtr : $8e76          36470
             ASlToNt : $8e7a          36474
              ATnAcc : $8e6f          36463
             ATnDelt : $8e80          36480
             ATnSlDl : $8e7d          36477
             ATSlCnt : $8e6c          36460
             ATSlStp : $8e7e          36478
             AVolume : $8e83          36483
              AYREGS : $8ec4          36548
             BCOnOff : $8e8e          36494
             BCrAmSl : $8e86          36486
             BCrEnSl : $8e88          36488
             BCrNsSl : $8e87          36487
             BCrTnSl : $8e8a          36490
             BEnv_En : $8e98          36504
              BFlags : $8e99          36505
             BNNtSkp : $8e95          36501
               BNote : $8e96          36502
             BNtSkCn : $8e9f          36511
             BOffOnD : $8e90          36496
             BOnOffD : $8e8f          36495
             BOrnPtr : $8e91          36497
             BPsInOr : $8e84          36484
             BPsInSm : $8e85          36485
             BSamPtr : $8e93          36499
             BSlToNt : $8e97          36503
              BTnAcc : $8e8c          36492
             BTnDelt : $8e9d          36509
             BTnSlDl : $8e9a          36506
             BTSlCnt : $8e89          36489
             BTSlStp : $8e9b          36507
             BVolume : $8ea0          36512
                bres : $846c          33900
AS65 Assembler for R6502 [1.42].                                     Page    2
---------------------------------- ppt3.asm ----------------------------------

             CCOnOff : $8eab          36523
             CCrAmSl : $8ea3          36515
             CCrEnSl : $8ea5          36517
             CCrNsSl : $8ea4          36516
             CCrTnSl : $8ea7          36519
             CEnv_En : $8eb5          36533
              CFlags : $8eb6          36534
             CHECKLP : $8024          32804
              CHREGS : $86c9          34505
             CH_AMIN : $88ae          34990
              CH_AMP : $8890          34960
             CH_APOS : $88cc          35020
              CH_ENV : $88ef          35055
             CH_EXIT : $8960          35168
              CH_MIX : $8959          35161
             CH_NOAC : $87cc          34764
             CH_NOAM : $88bd          35005
             CH_NOEN : $88fd          35069
              CH_NOK : $8743          34627
              CH_NTP : $873d          34621
             CH_ONDL : $89a7          35239
             CH_ORPS : $872d          34605
             CH_SMPS : $878b          34699
             CH_STPP : $886c          34924
             CH_SVAM : $88b7          34999
              CH_VOL : $88d2          35026
               ChanA : $8e67          36455
               ChanB : $8e84          36484
               ChanC : $8ea1          36513
             CNNtSkp : $8eb2          36530
               CNote : $8eb3          36531
             CNtSkCn : $8ebc          36540
             COffOnD : $8ead          36525
              COnOff : $000a             10   *
             COnOffD : $8eac          36524
              CORR_1 : $8272          33394
              CORR_2 : $8291          33425
             COrnPtr : $8eae          36526
             CPsInOr : $8ea1          36513
             CPsInSm : $8ea2          36514
              CrAmSl : $0002              2   *
              CrEnSl : $0004              4   *
              CrNsSl : $0003              3   *
             CrPsPtr : $800d          32781
              CrTnSl : $0006              6   *
             CSamPtr : $8eb0          36528
             CSlToNt : $8eb4          36532
              CTnAcc : $8ea9          36521
             CTnDelt : $8eba          36538
             CTnSlDl : $8eb7          36535
             CTSlCnt : $8ea6          36518
             CTSlStp : $8eb8          36536
             CurEDel : $8ec1          36545
             CurESld : $8ebf          36543
             CVolume : $8ebd          36541
             C_DELAY : $862f          34351
             C_ENGLS : $8609          34313
             C_GLISS : $8576          34166
               C_NOP : $8679          34425
             C_ORPOS : $85cc          34252
             C_PORTM : $847a          33914
             C_SMPOS : $85bd          34237
AS65 Assembler for R6502 [1.42].                                     Page    3
---------------------------------- ppt3.asm ----------------------------------

             C_VIBRT : $85db          34267
               Delay : $8ac4          35524
             DelyCnt : $8ebe          36542
         EMPTYSAMORN : $8e01          36353   *
                 Env : $000b             11   *
             EnvBase : $8ed2          36562   *
               EnvTp : $000d             13   *
             Env_Del : $8b89          35721
              Env_En : $0014             20   *
             ESldAdd : $8b8e          35726
            FILE_END : $8e67          36455   *
           FIX16BITS : $8d62          36194
               Flags : $0015             21   *
                GL36 : $85a0          34208
                INIT : $804b          32843
              INITV1 : $82ee          33518
              INITV2 : $82d8          33496
           LOOP_LDIR : $80e3          32995
             LPosPtr : $89fb          35323
                  L1 : $81e0          33248
                  L2 : $8210          33296
                 L20 : $8154          33108
                 L21 : $8156          33110
                  L3 : $8214          33300
             MDADDR2 : $8698          34456
               Mixer : $0007              7   *
             MODADDR : $8355          33621
                MUTE : $8039          32825
                  M1 : $82c9          33481
                  M2 : $82f0          33520
                  M3 : $8321          33569
              NNtSkp : $0011             17   *
               NOSIG : $853b          34107
             NO_ENAC : $892c          35116
             NO_ENSL : $8940          35136
               Noise : $0006              6   *
                Note : $0012             18   *
             Ns_Base : $8ec2          36546
     Ns_Base_AddToNs : $8ec2          36546
                 NT_ : $8fc4          36804
             NT_DATA : $8db1          36273
              NtSkCn : $001b             27   *
              OffOnD : $000c             12   *
             OLDPRTM : $8511          34065
              OnOffD : $000b             11   *
              OrnPtr : $000d             13   *
             OrnPtrs : $8687          34439
               OUT_S : $8d45          36165
             PatsPtr : $8a22          35362
              PD_ENV : $839e          33694
             PD_EOff : $837b          33659
             PD_ESAM : $83aa          33706
              PD_FIN : $8471          33905
             PD_LOOP : $83da          33754
              PD_LP2 : $83de          33758
             PD_NOIS : $8447          33863
             PD_NOTE : $8458          33880
              PD_ORN : $83a4          33700
             PD_OrSm : $8329          33577
              PD_REL : $844d          33869
              PD_RES : $8464          33892
              PD_SAM : $8341          33601
AS65 Assembler for R6502 [1.42].                                     Page    4
---------------------------------- ppt3.asm ----------------------------------

             PD_SAM_ : $8342          33602
             PD_SorE : $8386          33670
              PD_VOL : $8368          33640
                PLAY : $89ac          35244
               PLNLP : $8a0c          35340
                PL1A : $8a6b          35435
                PL1B : $8a80          35456
                PL1C : $8aa2          35490
                PL1D : $8ac4          35524
                 PL2 : $8ac9          35529
              PrNote : $84be          33982
             PrSlide : $8504          34052
                PSP_ : $8a6b          35435
              PsInOr : $0000              0   *
              PsInSm : $0001              1   *
             PTDECOD : $83c6          33734
            Revision : $0030             48   *
                ROUT : $8b9d          35741
              SamPtr : $000f             15   *
             SamPtrs : $8344          33604
              SETENV : $863d          34365
              SETORN : $867a          34426
               SETUP : $00b0            176
             SET_STP : $855f          34143
              SlToNt : $0013             19   *
        SND_DESELECT : $00dd            221   *
         SND_SELREAD : $00df            223   *
      SND_SELSETADDR : $00ff            255   *
        SND_SELWRITE : $00fd            253   *
             SPCCOMS : $86a9          34473
               START : $8000          32768
                  sa : $819c          33180
                 saa : $85a0          34208
                 sac : $85ba          34234
                 sad : $85c7          34247
                 sae : $85d6          34262
                 saf : $85e5          34277
                 sag : $85f7          34295
                 sah : $862e          34350
                 sak : $8639          34361
                 sam : $8664          34404
                 saq : $86e7          34535
                saq1 : $8815          34837
                saq2 : $8973          35187
                 sar : $89ef          35311
                 sas : $8988          35208
                 sat : $8994          35220
                sat1 : $89c1          35265
                sat2 : $89c9          35273
                sat3 : $89da          35290
                 sau : $8b4d          35661
                sau1 : $8b4f          35663
                  sb : $81a0          33184
                 sb1 : $81a2          33186
                  sc : $81f0          33264
                  sd : $8221          33313
                  sf : $8244          33348
                  sg : $8250          33360
                 sg1 : $825d          33373
                  sh : $82ab          33451
                  si : $82fd          33533
                  sj : $833c          33596
AS65 Assembler for R6502 [1.42].                                     Page    5
---------------------------------- ppt3.asm ----------------------------------

                 sj1 : $8341          33601
                  sl : $8397          33687
                  sm : $83b9          33721
                  sn : $83c3          33731
                  so : $83e8          33768
                 so1 : $83f2          33778
                so11 : $83f9          33785
                 so2 : $83fe          33790
                 so3 : $8407          33799
                 so4 : $840e          33806
                 so5 : $8413          33811
                 so6 : $8420          33824
                 so7 : $842d          33837
                  st : $8499          33945
                  sw : $8527          34087
                  sy : $858a          34186
                  sz : $859e          34206
                  s1 : $8031          32817
                  s2 : $80a5          32933
                 s7b : $8161          33121
                 s8b : $8162          33122
                 s9b : $8198          33176
                 TA1 : $00bb            187   *
                 TA2 : $00bc            188   *
                 TB1 : $00bd            189   *
                 TB2 : $00be            190   *
                 TB3 : $00c1            193   *
             TCNEW_0 : $8deb          36331
             TCNEW_1 : $8dcd          36301   *
             TCNEW_2 : $8df6          36342
             TCNEW_3 : $8de1          36321
             TCOLD_0 : $8dc1          36289
             TCOLD_1 : $8dcd          36301
             TCOLD_2 : $8dcf          36303
             TCOLD_3 : $8de2          36322
                 TC1 : $00bf            191   *
                 TC2 : $00c0            192   *
                 TC3 : $00c2            194   *
             TC_EXIT : $82ae          33454
               TnAcc : $0008              8   *
              TnDelt : $0019             25   *
              TnSlDl : $0016             22   *
                TonA : $0000              0   *
                TonB : $0002              2   *
                TonC : $0004              4   *
              TSlCnt : $0005              5   *
              TSlStp : $0017             23   *
                 T1_ : $8e05          36357
                  T_ : $8dc1          36289
             T_NEW_0 : $8e37          36407   *
             T_NEW_1 : $8e05          36357   *
             T_NEW_2 : $8e4f          36431   *
             T_NEW_3 : $8e35          36405   *
             T_OLD_0 : $8e37          36407   *
             T_OLD_1 : $8e05          36357   *
             T_OLD_2 : $8e1d          36381   *
             T_OLD_3 : $8e35          36405   *
                VARS : $8e67          36455
            VARS_END : $9084          36996   *
             VAR0END : $8ed4          36564   *
             Version : $84fc          34044
             VIA_ORA : $030f            783   *
AS65 Assembler for R6502 [1.42].                                     Page    6
---------------------------------- ppt3.asm ----------------------------------

             VIA_PCR : $030c            780   *
              Volume : $001c             28   *
                 VT_ : $8ec4          36548
                val1 : $00bb            187
                val2 : $00bd            189
                val3 : $00bf            191
                val4 : $00c1            193
               z80_A : $00b1            177
              z80_AP : $00ba            186
               z80_B : $00b3            179
               z80_C : $00b2            178
               z80_D : $00b5            181
               z80_E : $00b4            180
               z80_H : $00b7            183
              z80_IX : $00b8            184
               z80_L : $00b6            182
            __6502__ : $0001              1

323 labels used

2363 lines read, no errors in pass 1.
AS65 Assembler for R6502 [1.42].                                     Page    7
---------------------------------- ppt3.asm ----------------------------------

                             ; ===============================================
                             ; Vortex Tracker II v1.0 PT3 player for 6502
                             ; ORIC 1/ATMOS (6502) version
                             ; ScalexTrixx (A.C) - (c)2018
                             ;
                             ; Translated and adapted from ZX Spectrum Player 
                             ; by S.V.Bulba (with Ivan Roshin for some parts/a
                             ; https://bulba.untergrund.net/main_e.htm (c)2004
                             ;
0030 =                       Revision = "0" 
                             ; ===============================================
                             ; REV 0: 
                             ; ======
                             ; rev 0.34 (WK/TS)  - correction / 1.773 (288=x25
                             ;                   => file_end = $8E68
                             ;
                             ; rev 0.33 (WK)     - optimizations: PTDECOD
                             ;                   => file_end = $8E53
                             ;
                             ; rev 0.32 (WK)     - optimizations: PLAY
                             ;                   => file_end = $8F43
                             ;
                             ; rev 0.31 (WK)     - optimizations: CHREGS
                             ;                   => file_end = $8FC4
                             ;
                             ; rev 0.30 (WK)     - New base "full working" ver
                             ;                   - optimizations: zp variables
                             ;                   => file_end = $9027
                             ;
                             ; --------------------------------
                             ; WK: working / TS: test version |
                             ; ===============================================
                             ; TODO:
                             ; - lda ($AC),y -> lda ($AC,x)
                             ; - NOISE Register opt (/2 ?)
                             ; - déplacer / 1.773 avant CHREGS (cf CPC versio
                             ; - dans PD_LOOP: vérifier si des jmp relatifs s
                             ; - fix .bbs address
                             ; - check zero pages addresses
                             ; ===============================================
                             ;
                             ;	ORG $8000
                             ;
                             ; -------------------------------------
                                     bss
                             
00b0 =                       	org $b0
                                 
00b0 =                       SETUP   ds 1      ; set bit0 to 1, if you want to
                                                ; bit7 is set each time, when 
                             ; "registers" Z80
                             ; A = A
                             ; F = flags
                             
00b1 =                       z80_A   ds 1      ; save A
00b2 =                       z80_C   ds 1
00b3 =                       z80_B   ds 1
00b4 =                       z80_E   ds 1
00b5 =                       z80_D   ds 1
00b6 =                       z80_L   ds 1
00b7 =                       z80_H   ds 1
00b8 =                       z80_IX  ds 2
AS65 Assembler for R6502 [1.42].                                     Page    8
---------------------------------- ppt3.asm ----------------------------------

00ba =                       z80_AP  ds 1      ; save A'
                             ; temp variable used during play
00bb =                       val1    ds 2
00bd =                       val2    ds 2
00bf =                       val3    ds 2
00c1 =                       val4    ds 2
00bb =                       TA1 = val1
00bc =                       TA2 = val1+1
00bd =                       TB1 = val2
00be =                       TB2 = val2+1
00bf =                       TC1 = val3
00c0 =                       TC2 = val3+1
00c1 =                       TB3 = val4
00c2 =                       TC3 = val4+1
                             ; =====================================
                             ; module PT3 address
                             ;MDLADDR = $2000
                             ; =====================================
                                     code
                             ; For dflat, allow build of code for other locati
                              if RELOCADDR
                                     org RELOCADDR
                              else
8000 =                               org $8000
                              endif
                             
                             ; START = $8000
                             ; START+00 : INIT
                             ; START+10 : PLAY
                             ; START+13 : MUTE
                             
8000 :                       START
                             ; For dflat, assume that A,X provides address of 
                             ;        lda #lo(MDLADDR)                        
                             ;        sta z80_L
                             ;        lda #hi(MDLADDR)
                             ;        sta z80_H
8000 : 85b6             [ 3]         sta z80_L
8002 : 86b7             [ 3]         stx z80_H
8004 : 18               [ 2]         clc
8005 : 9044             [ 3] 	bcc INIT            ; always                    
8007 : 4cac89           [ 3] 	jmp PLAY                                        
800a : 4c3980           [ 3] 	jmp MUTE                                        
                                  
800d : 0000                  CrPsPtr	fcw 0 ; current position in PT3 module
                             
                             ;Identifier
800f : 3d565449492050..      	    db "=VTII PT3 Player r.",Revision,"="
                             
8024 :                       CHECKLP
                             	                                                
8024 : a5b0             [ 3]         lda SETUP                                
8026 : 0980             [ 2]         ora #%10000000                           
8028 : 85b0             [ 3]         sta SETUP
802a : a901             [ 2] 	lda #%00000001                                  
802c : 24b0             [ 3]         bit SETUP
802e : d001             [ 3]         bne s1                                   
8030 : 60               [ 6] 	rts
8031 : 68               [ 4] s1	pla                                           
8032 : 68               [ 4]         pla       ; dépile 2 fois puisque rts sh
8033 : eebe8e           [ 6] 	inc DelyCnt                                     
8036 : ee828e           [ 6]         inc ANtSkCn                              
AS65 Assembler for R6502 [1.42].                                     Page    9
---------------------------------- ppt3.asm ----------------------------------

8039 :                       MUTE	                                            
8039 : a900             [ 2]         lda #00                                  
803b : 85b7             [ 3]         sta z80_H                                
803d : 85b6             [ 3] 	sta z80_L                                       
803f : 8dcc8e           [ 4] 	sta AYREGS+AmplA                                
8042 : 8dcd8e           [ 4] 	sta AYREGS+AmplB                                
8045 : 8dce8e           [ 4]         sta AYREGS+AmplC
8048 : 4c9d8b           [ 3] 	jmp ROUT                                        
                             
804b :                       INIT
                             
804b : a5b6             [ 3] 	lda z80_L                                       
804d : 8d5683           [ 4] 	sta MODADDR+1
8050 : 8d9986           [ 4]         sta MDADDR2+1
8053 : 85b8             [ 3]         sta z80_IX
8055 : 48               [ 3]         pha
8056 : a5b7             [ 3]         lda z80_H
8058 : 8d5c83           [ 4]         sta MODADDR+7
805b : 8d9f86           [ 4]         sta MDADDR2+7
805e : 85b9             [ 3]         sta z80_IX+1
8060 : 48               [ 3]         pha
8061 : a964             [ 2]         lda #lo(100)                             
8063 : 85b4             [ 3]         sta z80_E
8065 : a900             [ 2]         lda #00
8067 : 85b5             [ 3]         sta z80_D
8069 : a8               [ 2]         tay
806a : 18               [ 2] 	clc                                             
806b : a5b4             [ 3]         lda z80_E
806d : 65b6             [ 3]         adc z80_L
806f : 85b6             [ 3]         sta z80_L
8071 : a5b7             [ 3]         lda z80_H
8073 : 6900             [ 2]         adc #00
8075 : 85b7             [ 3]         sta z80_H
8077 : b1b6             [ 5]         lda (z80_L),y                            
8079 : 8dc58a           [ 4] 	sta Delay+1                                     
807c : a5b4             [ 3]         lda z80_E
807e : 65b6             [ 3]         adc z80_L
8080 : 85b6             [ 3]         sta z80_L
8082 : 8d0d80           [ 4]         sta CrPsPtr                              
8085 : a5b7             [ 3]         lda z80_H
8087 : 6900             [ 2]         adc #00
8089 : 85b7             [ 3]         sta z80_H    
808b : 8d0e80           [ 4]         sta CrPsPtr+1
808e : a066             [ 2] 	ldy #102               
8090 : b1b8             [ 5]         lda (z80_IX),y
8092 : 85b4             [ 3]         sta z80_E
8094 : 18               [ 2] 	clc                                             
8095 : 65b6             [ 3]         adc z80_L
8097 : 85b6             [ 3]         sta z80_L
8099 : a5b7             [ 3]         lda z80_H
809b : 6900             [ 2]         adc #00
809d : 85b7             [ 3]         sta z80_H       
809f : e6b6             [ 5] 	inc z80_L                                       
80a1 : d002             [ 3]         bne s2
80a3 : e6b7             [ 5]         inc z80_H
80a5 : a5b6             [ 3] s2	lda z80_L                                     
80a7 : 8dfc89           [ 4]         sta LPosPtr+1
80aa : a5b7             [ 3]         lda z80_H
80ac : 8d008a           [ 4]         sta LPosPtr+5
80af : 68               [ 4] 	pla                                             
80b0 : 85b5             [ 3]         sta z80_D
80b2 : 68               [ 4]         pla
AS65 Assembler for R6502 [1.42].                                     Page   10
---------------------------------- ppt3.asm ----------------------------------

80b3 : 85b4             [ 3]         sta z80_E
80b5 : a067             [ 2] 	ldy #103               
80b7 : b1b8             [ 5]         lda (z80_IX),y
80b9 : 18               [ 2] 	clc                                             
80ba : 65b4             [ 3]         adc z80_E
80bc : 8d238a           [ 4]         sta PatsPtr+1   
80bf : a068             [ 2]         ldy #104                  
80c1 : b1b8             [ 5]         lda (z80_IX),y
80c3 : 65b5             [ 3]         adc z80_D
80c5 : 8d2a8a           [ 4]         sta PatsPtr+8
80c8 : a9a9             [ 2]         lda #lo(169)                             
80ca : 18               [ 2]         clc                                      
80cb : 65b4             [ 3]         adc z80_E
80cd : 8d8886           [ 4]         sta OrnPtrs+1   
80d0 : a900             [ 2]         lda #00
80d2 : 65b5             [ 3]         adc z80_D
80d4 : 8d8f86           [ 4]         sta OrnPtrs+8
80d7 : a969             [ 2]         lda #lo(105)                             
80d9 : 18               [ 2]         clc                                      
80da : 65b4             [ 3]         adc z80_E
80dc : 8d4583           [ 4]         sta SamPtrs+1
80df : a900             [ 2]         lda #00
                                     ;INIT zeroes from VARS to VAR0END-1 (area
80e1 : a06c             [ 2]         ldy #(VAR0END-VARS-1)
80e3 :                       LOOP_LDIR 
80e3 : 99678e           [ 5]         sta VARS,y
80e6 : 88               [ 2]         dey         ; (carry not modified)
80e7 : 10fa             [ 3]         bpl LOOP_LDIR
                                     ; A = #00  
80e9 : 65b5             [ 3]         adc z80_D
80eb : 8d4c83           [ 4]         sta SamPtrs+8                            
80ee : a5b0             [ 3]         lda SETUP                                
80f0 : 297f             [ 2]         and #%01111111
80f2 : 85b0             [ 3]         sta SETUP
                                     
80f4 : a905             [ 2] 	lda #lo(T1_)
80f6 : 85b4             [ 3]         sta z80_E
80f8 : a98e             [ 2]         lda #hi(T1_)
80fa : 85b5             [ 3]         sta z80_D
80fc : a901             [ 2]         lda #$01                                 
80fe : 8dbe8e           [ 4] 	sta DelyCnt                                     
8101 : 8d828e           [ 4]         sta ANtSkCn
8104 : 8d9f8e           [ 4]         sta BNtSkCn
8107 : 8dbc8e           [ 4]         sta CNtSkCn
810a : a9f0             [ 2]         lda #$F0
810c : 8d838e           [ 4] 	sta AVolume                                     
810f : 8da08e           [ 4] 	sta BVolume                                     
8112 : 8dbd8e           [ 4] 	sta CVolume                                     
8115 : a901             [ 2]         lda #lo(EMPTYSAMORN)                     
8117 : 85b6             [ 3]         sta z80_L
8119 : 8dca89           [ 4]         sta AdInPtA+1
811c : 8d748e           [ 4]         sta AOrnPtr
811f : 8d918e           [ 4]         sta BOrnPtr
8122 : 8dae8e           [ 4]         sta COrnPtr
8125 : 8d768e           [ 4]         sta ASamPtr
8128 : 8d938e           [ 4]         sta BSamPtr
812b : 8db08e           [ 4]         sta CSamPtr
812e : a98e             [ 2]         lda #hi(EMPTYSAMORN)
8130 : 85b7             [ 3]         sta z80_H
8132 : 8dce89           [ 4] 	sta AdInPtA+5                                   
8135 : 8d758e           [ 4] 	sta AOrnPtr+1                                   
8138 : 8d928e           [ 4] 	sta BOrnPtr+1                                   
AS65 Assembler for R6502 [1.42].                                     Page   11
---------------------------------- ppt3.asm ----------------------------------

813b : 8daf8e           [ 4] 	sta COrnPtr+1                                   
813e : 8d778e           [ 4] 	sta ASamPtr+1                                   
8141 : 8d948e           [ 4] 	sta BSamPtr+1                                   
8144 : 8db18e           [ 4] 	sta CSamPtr+1                                   
                             	    			                                         
                                     
8147 : a00d             [ 2] 	ldy #13                    
8149 : b1b8             [ 5]         lda (z80_IX),y
814b : 38               [ 2]         sec                                      
814c : e930             [ 2]         sbc #$30        ; ascii value - 30 = vers
814e : 9004             [ 3] 	bcc L20         ; inverse (pour SUB aussi)      
8150 : c90a             [ 2] 	cmp #10                                         
8152 : 9002             [ 3] 	bcc L21         ; < 10                          
8154 :                       L20	    
8154 : a906             [ 2]         lda #6          ; version par defaut si i
8156 :                       L21	    
8156 : 8dfd84           [ 4]         sta Version+1                            
8159 : 48               [ 3] 	pha             ; save version nb
815a : c904             [ 2]         cmp #4          ; version 4 ?            
815c : 9003             [ 3]         bcc s7b         ; < 4 (inverse carry)
815e : 18               [ 2]         clc
815f : 9001             [ 3]         bcc s8b         ; always
8161 : 38               [ 2] s7b     sec
8162 : a063             [ 2] s8b     ldy #99                 
8164 : b1b8             [ 5]         lda (z80_IX),y  
8166 : 2a               [ 2]         rol a           ; carry !                
8167 : 2907             [ 2] 	and #7          ; clear all bit except 0-1-2    
8169 : aa               [ 2]         tax             ; save A
                             ;NoteTableCreator (c) Ivan Roshin
                             ;A - NoteTableNumber*2+VersionForNoteTable
                             ;(xx1b - 3.xx..3.4r, xx0b - 3.4x..3.6x..VTII1.0)
                             
816a : a9b1             [ 2]      	lda #lo(NT_DATA)											    
816c : 85b6             [ 3]      	sta z80_L
816e : a98d             [ 2]      	lda #hi(NT_DATA)
8170 : 85b7             [ 3]      	sta z80_H
8172 : a5b4             [ 3]      	lda z80_E													
8174 : 85b2             [ 3]      	sta z80_C
8176 : a5b5             [ 3]      	lda z80_D
8178 : 85b3             [ 3]      	sta z80_B
817a : a900             [ 2]      	lda #00
817c : a8               [ 2]         tay           ; ldy #00	        
817d : 85b5             [ 3]      	sta z80_D
817f : 8a               [ 2]      	txa           ; restore A									
8180 : 0a               [ 2]      	asl a															
8181 : 85b4             [ 3]      	sta z80_E													
8183 : 18               [ 2]      	clc                                        
8184 : 65b6             [ 3]         adc z80_L
8186 : 85b6             [ 3]         sta z80_L
8188 : a5b5             [ 3]         lda z80_D
818a : 65b7             [ 3]         adc z80_H
818c : 85b7             [ 3]         sta z80_H													
818e : b1b6             [ 5]      	lda (z80_L),y												
8190 : 85b4             [ 3]      	sta z80_E
8192 : e6b6             [ 5]      	inc z80_L                                  
8194 : d002             [ 3]         bne s9b
8196 : e6b7             [ 5]         inc z80_H
8198 :                       s9b 
8198 : 46b4             [ 5] 	lsr z80_E											    				     				
819a : b004             [ 3] 	bcs sb		; si c = 0 => $EA (NOP) / si c = 1 => $1
819c : a9ea             [ 2] sa  	lda #$EA 	; -> $EA (NOP)
819e : d002             [ 3]         bne sb1		; always	
AS65 Assembler for R6502 [1.42].                                     Page   12
---------------------------------- ppt3.asm ----------------------------------

81a0 : a918             [ 2] sb	lda #$18	; -> $18 (clc) 									
81a2 : 8d1482           [ 4] sb1	sta L3		            									
81a5 : a5b4             [ 3] 	lda z80_E													
81a7 : a6b6             [ 3] 	ldx z80_L
81a9 : 85b6             [ 3] 	sta z80_L
81ab : 86b4             [ 3] 	stx z80_E
81ad : a5b5             [ 3] 	lda z80_D
81af : a6b7             [ 3] 	ldx z80_H
81b1 : 85b7             [ 3] 	sta z80_H
81b3 : 86b5             [ 3] 	stx z80_D
81b5 : 18               [ 2] 	clc                                             
81b6 : a5b2             [ 3]     	lda z80_C
81b8 : 65b6             [ 3]     	adc z80_L
81ba : 85b6             [ 3]     	sta z80_L
81bc : a5b3             [ 3]     	lda z80_B
81be : 65b7             [ 3]     	adc z80_H
81c0 : 85b7             [ 3]     	sta z80_H
                             
81c2 : b1b4             [ 5] 	lda (z80_E),y												
81c4 : 18               [ 2] 	clc                                             
81c5 : 69c1             [ 2]         adc #lo(T_)
81c7 : 85b2             [ 3] 	sta z80_C
81c9 : 48               [ 3]         pha                                      
81ca : 698d             [ 2]         adc #hi(T_)                              
81cc : 38               [ 2] 	sec                                             
81cd : e5b2             [ 3]         sbc z80_C
81cf : 85b3             [ 3]         sta z80_B                                
81d1 : 48               [ 3] 	pha
                             
81d2 : a9c4             [ 2] 	lda #lo(NT_)											
81d4 : 85b4             [ 3] 	sta z80_E
81d6 : 48               [ 3] 	pha															
81d7 : a98f             [ 2] 	lda #hi(NT_)
81d9 : 85b5             [ 3] 	sta z80_D
81db : 48               [ 3] 	pha
81dc : a90c             [ 2] 	lda #12														
81de : 85b3             [ 3] 	sta z80_B
81e0 :                       L1	    
81e0 : a5b2             [ 3]         lda z80_C													
81e2 : 48               [ 3] 	pha
81e3 : a5b3             [ 3] 	lda z80_B
81e5 : 48               [ 3] 	pha
81e6 : b1b6             [ 5] 	lda (z80_L),y												
81e8 : 85b2             [ 3] 	sta z80_C
81ea : e6b6             [ 5] 	inc z80_L                                       
81ec : d002             [ 3]         bne sc
81ee : e6b7             [ 5]         inc z80_H
81f0 :                       sc     
81f0 : a5b6             [ 3] 	lda z80_L												    
81f2 : 48               [ 3] 	pha
81f3 : a5b7             [ 3] 	lda z80_H
81f5 : 48               [ 3] 	pha
81f6 : b1b6             [ 5] 	lda (z80_L),y												
81f8 : 85b3             [ 3] 	sta z80_B
                             
81fa : a5b4             [ 3] 	lda z80_E       												
81fc : 85b6             [ 3] 	sta z80_L
81fe : 48               [ 3]         pha
81ff : a5b5             [ 3] 	lda z80_D
8201 : 85b7             [ 3] 	sta z80_H
8203 : 48               [ 3]         pha
8204 : a917             [ 2] 	lda #lo(23)		    										
AS65 Assembler for R6502 [1.42].                                     Page   13
---------------------------------- ppt3.asm ----------------------------------

8206 : 85b4             [ 3] 	sta z80_E
8208 : a900             [ 2] 	lda #hi(23)
820a : 85b5             [ 3] 	sta z80_D
820c : a908             [ 2] 	lda #8														
820e : 85b9             [ 3] 	sta z80_IX+1
                                     
8210 :                       L2	    
8210 : 46b3             [ 5]         lsr z80_B													
8212 : 66b2             [ 5] 	ror z80_C													
8214 :                       L3	    
8214 : ac                    	fcb $AC			; clc ($18) or NOP ($EA)
8215 : a5b2             [ 3] 	lda z80_C													
8217 : 6900             [ 2] 	adc #00  		    								    	
8219 : 91b6             [ 5] 	sta (z80_L),y												
821b : e6b6             [ 5] 	inc z80_L                                       
821d : d002             [ 3]         bne sd
821f : e6b7             [ 5]         inc z80_H
8221 :                       sd      
8221 : a5b3             [ 3]         lda z80_B													
8223 : 6900             [ 2] 	adc #00 													
8225 : 91b6             [ 5] 	sta (z80_L),y												
8227 : 18               [ 2] 	clc                                             
8228 : a5b4             [ 3]         lda z80_E
822a : 65b6             [ 3]         adc z80_L
822c : 85b6             [ 3]         sta z80_L
822e : a5b5             [ 3]         lda z80_D
8230 : 65b7             [ 3]         adc z80_H
8232 : 85b7             [ 3]         sta z80_H
8234 : c6b9             [ 5] 	dec z80_IX+1											    
8236 : d0d8             [ 3] 	bne L2														
                             
8238 : 68               [ 4] 	pla															
8239 : 85b5             [ 3] 	sta z80_D
823b : 68               [ 4] 	pla         
823c : 6902             [ 2]         adc #02     
823e : 85b4             [ 3]         sta z80_E   
8240 : 9002             [ 3]         bcc sf      
8242 : e6b5             [ 5]         inc z80_D 
                             
8244 :                       sf     
8244 : 68               [ 4] 	pla												    	    
8245 : 85b7             [ 3] 	sta z80_H
8247 : 68               [ 4] 	pla
8248 : 85b6             [ 3] 	sta z80_L
824a : e6b6             [ 5] 	inc z80_L                                       
824c : d002             [ 3]         bne sg
824e : e6b7             [ 5]         inc z80_H
8250 :                       sg     
8250 : 68               [ 4] 	pla												    	    
8251 : 85b3             [ 3] 	sta z80_B
8253 : 68               [ 4] 	pla
8254 : 85b2             [ 3] 	sta z80_C
8256 : c6b3             [ 5] 	dec z80_B													
8258 : f003             [ 3] 	beq sg1
825a : 4ce081           [ 3]         jmp L1
825d :                       sg1        
825d : 68               [ 4] 	pla															
825e : 85b7             [ 3] 	sta z80_H
8260 : 68               [ 4] 	pla
8261 : 85b6             [ 3] 	sta z80_L
8263 : 68               [ 4] 	pla															
8264 : 85b5             [ 3] 	sta z80_D
AS65 Assembler for R6502 [1.42].                                     Page   14
---------------------------------- ppt3.asm ----------------------------------

8266 : 68               [ 4] 	pla
8267 : 85b4             [ 3] 	sta z80_E
                                     								
8269 : c9cd             [ 2] 	cmp #lo(TCOLD_1)		        								
826b : d005             [ 3]         bne CORR_1													
826d : a9fd             [ 2] 	lda #$FD													
826f : 8df28f           [ 4] 	sta NT_+$2E									 				
                             
8272 :                       CORR_1	
8272 : 18               [ 2]         clc                                      
8273 : b1b4             [ 5]         lda (z80_E),y																										
8275 : f037             [ 3] 	beq TC_EXIT													
8277 : 6a               [ 2] 	ror a															
8278 : 08               [ 3] 	php			    ; save carry														
8279 : 0a               [ 2] 	asl a															
827a : 85b2             [ 3] 	sta z80_C													
827c : 18               [ 2] 	clc                                             
827d : 65b6             [ 3]         adc z80_L
827f : 85b6             [ 3]         sta z80_L
8281 : a5b3             [ 3]         lda z80_B
8283 : 65b7             [ 3]         adc z80_H
8285 : 85b7             [ 3]         sta z80_H                                
8287 : 28               [ 4] 	plp             ; restore carry (du ror)	       
8288 : 9007             [ 3] 	bcc CORR_2                                      
828a : b1b6             [ 5] 	lda (z80_L),y												
828c : 38               [ 2] 	sec															
828d : e902             [ 2] 	sbc #$02
828f : 91b6             [ 5] 	sta (z80_L),y
                             	
8291 :                       CORR_2	
8291 : b1b6             [ 5]         lda (z80_L),y												
8293 : 18               [ 2] 	clc			
8294 : 6901             [ 2] 	adc #$01
8296 : 91b6             [ 5] 	sta (z80_L),y
8298 : 38               [ 2]         sec   		                                 
8299 : a5b6             [ 3] 	lda z80_L                                       
829b : e5b2             [ 3] 	sbc z80_C
829d : 85b6             [ 3] 	sta z80_L
829f : a5b7             [ 3] 	lda z80_H
82a1 : e5b3             [ 3] 	sbc z80_B
82a3 : 85b7             [ 3] 	sta z80_H
82a5 : e6b4             [ 5] 	inc z80_E                                       
82a7 : d002             [ 3]         bne sh
82a9 : e6b5             [ 5]         inc z80_D
82ab :                       sh     
82ab : 4c7282           [ 3] 	jmp CORR_1												    
                             
82ae :                       TC_EXIT
82ae : 68               [ 4] 	pla			; restore version number						
                             
                             ;VolTableCreator (c) Ivan Roshin
                             ;A - VersionForVolumeTable (0..4 - 3.xx..3.4x;
                             ;5.. - 3.5x..3.6x..VTII1.0)
                             
82af : c905             [ 2] 	cmp #5		; version 										
82b1 : a911             [ 2] 	lda #lo($11)                                    
82b3 : 85b6             [ 3] 	sta z80_L
82b5 : a900             [ 2]         lda #hi($11)													
82b7 : 85b7             [ 3] 	sta z80_H													
82b9 : 85b5             [ 3] 	sta z80_D                                       
82bb : 85b4             [ 3] 	sta z80_E													
82bd : a92a             [ 2] 	lda #$2A	; ($2A = rol A)								    
AS65 Assembler for R6502 [1.42].                                     Page   15
---------------------------------- ppt3.asm ----------------------------------

82bf : b008             [ 3] 	bcs M1		; CP -> carry inverse (CP 5)					
82c1 : c6b6             [ 5] 	dec z80_L													
82c3 : a5b6             [ 3] 	lda z80_L													
82c5 : 85b4             [ 3] 	sta z80_E
82c7 : a9ea             [ 2] 	lda #$EA	; ($EA = NOP)			    					
82c9 :                       M1          
82c9 : 8df082           [ 4]         sta M2														
82cc : a9d4             [ 2] 	lda #lo(VT_+16)												
82ce : 85b8             [ 3] 	sta z80_IX
82d0 : a98e             [ 2] 	lda #hi(VT_+16)
82d2 : 85b9             [ 3] 	sta z80_IX+1
82d4 : a910             [ 2] 	lda #$10													
82d6 : 85b2             [ 3] 	sta z80_C
                             
82d8 :                       INITV2  
82d8 : 18               [ 2]         clc
82d9 : a5b6             [ 3]         lda z80_L													
82db : 48               [ 3] 	pha
82dc : 65b4             [ 3]         adc z80_E
82de : 85b4             [ 3]         sta z80_E
82e0 : a5b7             [ 3] 	lda z80_H
82e2 : 48               [ 3] 	pha
82e3 : 65b5             [ 3]         adc z80_D
82e5 : 85b5             [ 3]         sta z80_D
                             	    
82e7 : a900             [ 2]         lda #00														
82e9 : 85b6             [ 3] 	sta z80_L
82eb : 85b7             [ 3] 	sta z80_H
82ed : 18               [ 2]         clc
82ee :                       INITV1  
82ee : a5b6             [ 3]         lda z80_L													
82f0 :                       M2          
82f0 : ac                            fcb $AC	    ; $EA (nop) ou $2A (rol)
82f1 : a5b7             [ 3] 	lda z80_H													
82f3 : 6900             [ 2] 	adc #00			; + carry                             
82f5 : 91b8             [ 5] 	sta (z80_IX),y												
82f7 : e6b8             [ 5] 	inc z80_IX                                      
82f9 : d002             [ 3]         bne si
82fb : e6b9             [ 5]         inc z80_IX+1
82fd :                       si     
82fd : 18               [ 2] 	clc                                             
82fe : a5b4             [ 3]         lda z80_E
8300 : 65b6             [ 3]         adc z80_L
8302 : 85b6             [ 3]         sta z80_L
8304 : a5b5             [ 3]         lda z80_D
8306 : 65b7             [ 3]         adc z80_H
8308 : 85b7             [ 3]         sta z80_H
830a : e6b2             [ 5] 	inc z80_C												    
830c : a5b2             [ 3] 	lda z80_C													
830e : 290f             [ 2] 	and #15														
8310 : 18               [ 2]         clc         ; carry cleared by and
8311 : d0db             [ 4] 	bne INITV1													
                             
8313 : 68               [ 4] 	pla															
8314 : 85b7             [ 3] 	sta z80_H
8316 : 68               [ 4] 	pla
8317 : 85b6             [ 3] 	sta z80_L
8319 : a5b4             [ 3] 	lda z80_E													
831b : c977             [ 2] 	cmp #$77													
831d : d002             [ 3] 	bne M3														
831f : e6b4             [ 5] 	inc z80_E													
8321 :                       M3      
AS65 Assembler for R6502 [1.42].                                     Page   16
---------------------------------- ppt3.asm ----------------------------------

8321 : 18               [ 2]         clc                                      
8322 : a5b2             [ 3]         lda z80_C																								
8324 : d0b2             [ 4] 	bne	INITV2													
                             
8326 : 4c9d8b           [ 3] 	jmp ROUT													
                             ; ===============================================
                             ; Pattern Decoder
8329 :                       PD_OrSm	
8329 : a014             [ 2]         ldy #Env_En     										    
832b : a900             [ 2] 	lda #00
832d : 91b8             [ 5] 	sta (z80_IX),y
832f : 207a86           [ 6] 	jsr SETORN													
8332 : a000             [ 2] 	ldy #00					; lda ($AC,x)									
8334 : b1b2             [ 5] 	lda (z80_C),y
8336 : e6b2             [ 5] 	inc z80_C                                       
8338 : d002             [ 3]         bne sj
833a : e6b3             [ 5]         inc z80_B
833c :                       sj     
833c : 4a               [ 2] 	lsr a 													    
833d : 9002             [ 3]         bcc sj1
833f : 0980             [ 2]         ora #$80
8341 :                       sj1     
8341 :                       PD_SAM	
8341 : 0a               [ 2]         asl a 											    		
8342 :                       PD_SAM_	
8342 : 85b4             [ 3]         sta z80_E													
8344 :                       SamPtrs		
8344 : a9ac             [ 2] 	lda #$AC				
8346 : 18               [ 2]         clc
8347 : 65b4             [ 3]         adc z80_E
8349 : 85b6             [ 3] 	sta z80_L
834b : a9ac             [ 2] 	lda #$AC
834d : 6900             [ 2]         adc #00
834f : 85b7             [ 3] 	sta z80_H
                             
8351 : a000             [ 2]         ldy #00
8353 : b1b6             [ 5] 	lda (z80_L),y
8355 :                       MODADDR		
8355 : 69ac             [ 2] 	adc #$AC												
8357 : aa               [ 2] 	tax             ; save
8358 : c8               [ 2] 	iny                                             
8359 : b1b6             [ 5] 	lda (z80_L),y
835b : 69ac             [ 2]         adc #$AC								    			
                             
835d : a010             [ 2] 	ldy #SamPtr+1         										
835f : 91b8             [ 5] 	sta (z80_IX),y
8361 : 88               [ 2] 	dey															
8362 : 8a               [ 2] 	txa         
8363 : 91b8             [ 5] 	sta (z80_IX),y
8365 : 4cda83           [ 3] 	jmp PD_LOOP													
                             
8368 :                       PD_VOL	
8368 : 0a               [ 2]         asl a															
8369 : 6900             [ 2]         adc #00
836b : 0a               [ 2] 	asl a															
836c : 6900             [ 2]         adc #00
836e : 0a               [ 2] 	asl a															
836f : 6900             [ 2]         adc #00
8371 : 0a               [ 2] 	asl a															
8372 : 6900             [ 2]         adc #00
8374 : a01c             [ 2] 	ldy #Volume         										
8376 : 91b8             [ 5] 	sta (z80_IX),y
AS65 Assembler for R6502 [1.42].                                     Page   17
---------------------------------- ppt3.asm ----------------------------------

8378 : 4cde83           [ 3]         jmp PD_LP2													
                             	
837b :                       PD_EOff	
837b : a014             [ 2]         ldy #Env_En		    	        							
837d : 91b8             [ 5] 	sta (z80_IX),y
837f : a000             [ 2] 	ldy #PsInOr   			    					    		
8381 : 91b8             [ 5] 	sta (z80_IX),y
8383 : 4cde83           [ 3] 	jmp PD_LP2													
                             
8386 :                       PD_SorE	
8386 : 38               [ 2]         sec															
8387 : e901             [ 2] 	sbc #01
8389 : 85b1             [ 3]         sta z80_A
838b : d011             [ 3] 	bne PD_ENV													
838d : a000             [ 2] 	ldy #00			        ; lda ($AC,x)												
838f : b1b2             [ 5] 	lda (z80_C),y
8391 : e6b2             [ 5] 	inc z80_C                                       
8393 : d002             [ 3]         bne sl
8395 : e6b3             [ 5]         inc z80_B
8397 :                       sl     
8397 : a011             [ 2] 	ldy #NNtSkp    		        								
8399 : 91b8             [ 5] 	sta (z80_IX),y
839b : 4cde83           [ 3]         jmp PD_LP2													
                             
839e :                       PD_ENV	
839e : 203d86           [ 6]         jsr SETENV													
83a1 : 4cde83           [ 3] 	jmp PD_LP2													
                             
83a4 :                       PD_ORN	
83a4 : 207a86           [ 6]         jsr SETORN													
83a7 : 4cda83           [ 3] 	jmp PD_LOOP													
                             
83aa :                       PD_ESAM	
83aa : a014             [ 2]         ldy #Env_En	             									
83ac : 91b8             [ 5] 	sta (z80_IX),y
83ae : a000             [ 2] 	ldy #PsInOr	    		        							
83b0 : 91b8             [ 5] 	sta (z80_IX),y
83b2 : a5b1             [ 3] 	lda z80_A           
83b4 : f003             [ 3]         beq sm														
83b6 : 203d86           [ 6] 	jsr SETENV
83b9 : a000             [ 2] sm	ldy #00			    ; lda ($AC,x)												
83bb : b1b2             [ 5] 	lda (z80_C),y
83bd : e6b2             [ 5] 	inc z80_C                                       
83bf : d002             [ 3]         bne sn
83c1 : e6b3             [ 5]         inc z80_B
83c3 :                       sn     
83c3 : 4c4283           [ 3]         jmp PD_SAM_								     			    
                             
83c6 :                       PTDECOD 
83c6 : a012             [ 2]         ldy #Note   							    				
83c8 : b1b8             [ 5] 	lda (z80_IX),y
83ca : 8dbf84           [ 4] 	sta PrNote+1												
83cd : a006             [ 2] 	ldy #CrTnSl    		    						    		
83cf : b1b8             [ 5] 	lda (z80_IX),y                                  
83d1 : 8d0585           [ 4] 	sta PrSlide+1												
83d4 : c8               [ 2]         iny 
83d5 : b1b8             [ 5] 	lda (z80_IX),y											
83d7 : 8d0c85           [ 4] 	sta PrSlide+8
                             
83da :                       PD_LOOP	
83da : a910             [ 2]         lda #$10													
83dc : 85b4             [ 3] 	sta z80_E
AS65 Assembler for R6502 [1.42].                                     Page   18
---------------------------------- ppt3.asm ----------------------------------

                             	
83de :                       PD_LP2	
83de : a000             [ 2]         ldy #00			    ; lda ($AC,x)												
83e0 : b1b2             [ 5] 	lda (z80_C),y
83e2 : e6b2             [ 5] 	inc z80_C                                       
83e4 : d002             [ 3]         bne so
83e6 : e6b3             [ 5]         inc z80_B
83e8 :                       so
83e8 : 18               [ 2] 	clc															
83e9 : 6910             [ 2] 	adc #$10
83eb : 9005             [ 3] 	bcc so1
83ed : 85b1             [ 3]         sta z80_A            
83ef : 4c2983           [ 3]         jmp PD_OrSm
83f2 : 6920             [ 2] so1     adc #$20                                 
83f4 : d003             [ 3] 	bne so11													
83f6 : 4c7184           [ 3]         jmp PD_FIN
83f9 : 9003             [ 3] so11	bcc so2													    
83fb : 4c4183           [ 3]         jmp PD_SAM
83fe : 6910             [ 2] so2	adc #$10                                     
8400 : f04b             [ 3] 	beq PD_REL													
8402 : 9003             [ 3] 	bcc so3 													
8404 : 4c6883           [ 3]         jmp PD_VOL
8407 : 6910             [ 2] so3	adc #$10                                     
8409 : d003             [ 3] 	bne so4										    			
840b : 4c7b83           [ 3]         jmp PD_EOff
840e : 9003             [ 3] so4	bcc	so5												    	
8410 : 4c8683           [ 3] 	jmp PD_SorE
8413 : 6960             [ 2] so5     adc #96                                  
8415 : b041             [ 3] 	bcs PD_NOTE													
8417 : 6910             [ 2] 	adc #$10                                        
8419 : 9005             [ 3] 	bcc so6
841b : 85b1             [ 3]         sta z80_A												    	
841d : 4ca483           [ 3]         jmp PD_ORN													
8420 : 6920             [ 2] so6	adc #$20                                     
8422 : b023             [ 3] 	bcs PD_NOIS													 														
8424 : 6910             [ 2] 	adc #$10                                        
8426 : 9005             [ 3]         bcc so7
8428 : 85b1             [ 3]         sta z80_A												    	
842a : 4caa83           [ 3]         jmp PD_ESAM
842d : 0a               [ 2] so7	asl a															
842e : 85b4             [ 3] 	sta z80_E
8430 : 18               [ 2]         clc                                      
8431 : 69c9             [ 2]         adc #lo(SPCCOMS+$FF20)							        
8433 : 85b6             [ 3]         sta z80_L
8435 : a985             [ 2] 	lda #hi(SPCCOMS+$FF20)
8437 : 6900             [ 2]         adc #00
8439 : 85b7             [ 3] 	sta z80_H
                                     ; on doit inverser le PUSH car l'adresse 
843b : a001             [ 2]         ldy #01	
843d : b1b6             [ 5] 	lda (z80_L),y												
843f : 48               [ 3] 	pha             ; push D
8440 : 88               [ 2] 	dey                                             
8441 : b1b6             [ 5] 	lda (z80_L),y										        
8443 : 48               [ 3] 	pha             ; push E
8444 : 4cda83           [ 3] 	jmp PD_LOOP													
                             
8447 :                       PD_NOIS									
8447 : 8dc28e           [ 4]         sta Ns_Base                              
844a : 4cde83           [ 3] 	jmp PD_LP2													
                             
844d :                       PD_REL	
844d : a015             [ 2]         ldy #Flags   								    			
AS65 Assembler for R6502 [1.42].                                     Page   19
---------------------------------- ppt3.asm ----------------------------------

844f : b1b8             [ 5] 	lda (z80_IX),y
8451 : 29fe             [ 2] 	and #%11111110
8453 : 91b8             [ 5] 	sta (z80_IX),y
8455 : 4c6484           [ 3] 	jmp PD_RES													
                             	
8458 :                       PD_NOTE	
8458 : a012             [ 2]         ldy #Note    	 				    						
845a : 91b8             [ 5] 	sta (z80_IX),y	
845c : a015             [ 2] 	ldy #Flags      											
845e : b1b8             [ 5] 	lda (z80_IX),y
8460 : 0901             [ 2] 	ora #%00000001
8462 : 91b8             [ 5] 	sta (z80_IX),y
                             	    													
8464 :                       PD_RES												
8464 : a900             [ 2]         lda #00	
8466 : 85b6             [ 3]         sta z80_L
8468 : 85b7             [ 3] 	sta z80_H
846a : a00b             [ 2] 	ldy #11
846c :                       bres
846c : 91b8             [ 5] 	sta (z80_IX),y          
846e : 88               [ 2] 	dey
846f : 10fb             [ 3]         bpl bres
8471 :                       PD_FIN	
8471 : a011             [ 2] 	ldy #NNtSkp     						    				
8473 : b1b8             [ 5] 	lda (z80_IX),y
8475 : a01b             [ 2] 	ldy #NtSkCn     		    								
8477 : 91b8             [ 5] 	sta (z80_IX),y
8479 : 60               [ 6] 	rts 														
                             
847a :                       C_PORTM
847a : a015             [ 2] 	ldy #Flags  												
847c : b1b8             [ 5] 	lda (z80_IX),y
847e : 29fb             [ 2] 	and #%11111011
8480 : 91b8             [ 5] 	sta (z80_IX),y
8482 : a000             [ 2] 	ldy #00			    ; lda ($AC,x)												
8484 : b1b2             [ 5] 	lda (z80_C),y
8486 : a016             [ 2]         ldy #TnSlDl     				    			    		
8488 : 91b8             [ 5] 	sta (z80_IX),y
848a : a005             [ 2]         ldy #TSlCnt	        			    						
848c : 91b8             [ 5] 	sta (z80_IX),y
                             
848e : 18               [ 2]         clc
848f : a5b2             [ 3]         lda z80_C
8491 : 6903             [ 2]         adc #03
8493 : 85b2             [ 3]         sta z80_C
8495 : 9002             [ 3]         bcc st
8497 : e6b3             [ 5]         inc z80_B
8499 :                       st     
8499 : a9c4             [ 2] 	lda #lo(NT_)			; OPT										
849b : 85b4             [ 3] 	sta z80_E
849d : a98f             [ 2] 	lda #hi(NT_)           ; OPT
849f : 85b5             [ 3] 	sta z80_D
84a1 : a012             [ 2] 	ldy #Note	        										
84a3 : b1b8             [ 5] 	lda (z80_IX),y
84a5 : a013             [ 2] 	ldy #SlToNt         										
84a7 : 91b8             [ 5] 	sta (z80_IX),y
84a9 : 0a               [ 2] 	asl a																																											
84aa : 18               [ 2] 	clc                                             
84ab : 65b4             [ 3]         adc z80_E           ; OPT
84ad : 85b6             [ 3]         sta z80_L
84af : a5b5             [ 3]         lda z80_D           ; OPT
84b1 : 6900             [ 2]         adc #00           
AS65 Assembler for R6502 [1.42].                                     Page   20
---------------------------------- ppt3.asm ----------------------------------

84b3 : 85b7             [ 3]         sta z80_H
84b5 : a000             [ 2]         ldy #00	
84b7 : b1b6             [ 5] 	lda (z80_L),y 												
84b9 : 48               [ 3] 	pha	
84ba : c8               [ 2] 	iny                                             
84bb : b1b6             [ 5] 	lda (z80_L),y 												
84bd : 48               [ 3] 	pha
84be :                       PrNote	
84be : a93e             [ 2]         lda #$3E													
84c0 : a012             [ 2] 	ldy #Note   					    						
84c2 : 91b8             [ 5] 	sta (z80_IX),y
84c4 : 0a               [ 2] 	asl a																																			
84c5 : 18               [ 2] 	clc                                             
84c6 : 65b4             [ 3]         adc z80_E           ; OPT
84c8 : 85b6             [ 3]         sta z80_L
84ca : a5b5             [ 3]         lda z80_D           ; OPT
84cc : 6900             [ 2]         adc #00
84ce : 85b7             [ 3]         sta z80_H
84d0 : a000             [ 2] 	ldy #00
84d2 : b1b6             [ 5]         lda (z80_L),y												
84d4 : 85b4             [ 3] 	sta z80_E
84d6 : c8               [ 2] 	iny                                             
84d7 : b1b6             [ 5] 	lda (z80_L),y											    
84d9 : 85b5             [ 3] 	sta z80_D
84db : a019             [ 2] 	ldy #TnDelt 
84dd : 68               [ 4]         pla															
84de : 85b7             [ 3] 	sta z80_H
84e0 : 68               [ 4] 	pla       
84e1 : 38               [ 2] 	sec                                             
84e2 : e5b4             [ 3]         sbc z80_E
84e4 : 85b6             [ 3]         sta z80_L
84e6 : 91b8             [ 5]         sta (z80_IX),y
84e8 : a5b7             [ 3]         lda z80_H
84ea : e5b5             [ 3]         sbc z80_D
84ec : 85b7             [ 3]         sta z80_H 
84ee : c8               [ 2]         iny                                      
84ef : 91b8             [ 5]         sta (z80_IX),y
84f1 : a006             [ 2] 	ldy #CrTnSl                                     
84f3 : b1b8             [ 5]         lda (z80_IX),y
84f5 : 85b4             [ 3]         sta z80_E
84f7 : c8               [ 2] 	iny                                             
84f8 : b1b8             [ 5]         lda (z80_IX),y
84fa : 85b5             [ 3]         sta z80_D
84fc :                       Version
84fc : a93e             [ 2] 	lda #$3E                                        
84fe : c906             [ 2] 	cmp #6                                          
8500 : 900f             [ 3] 	bcc OLDPRTM     ; < 6
8502 : a006             [ 2]         ldy #CrTnSl                              
8504 :                       PrSlide	
8504 : a9ac             [ 2]         lda #$AC                                 
8506 : 85b4             [ 3]         sta z80_E
8508 : 91b8             [ 5]         sta (z80_IX),y
850a : c8               [ 2]         iny
850b : a9ac             [ 2]         lda #$AC
850d : 85b5             [ 3]         sta z80_D
850f : 91b8             [ 5]         sta (z80_IX),y
                             	                                                
8511 :                       OLDPRTM	
8511 : a000             [ 2]         ldy #00                                  
8513 : b1b2             [ 5]         lda (z80_C),y
8515 : c8               [ 2]         iny                                      
8516 : 85ba             [ 3]         sta z80_AP                               
AS65 Assembler for R6502 [1.42].                                     Page   21
---------------------------------- ppt3.asm ----------------------------------

8518 : b1b2             [ 5] 	lda (z80_C),y                                   
851a : 85b1             [ 3] 	sta z80_A
851c : a5b2             [ 3]         lda z80_C
851e : 18               [ 2]         clc
851f : 6902             [ 2]         adc #02
8521 : 85b2             [ 3]         sta z80_C
8523 : 9002             [ 3]         bcc sw
8525 : e6b3             [ 5]         inc z80_B
8527 :                       sw
8527 : a5b1             [ 3] 	lda z80_A                                       
8529 : f010             [ 3] 	beq NOSIG                                       
852b : a5b4             [ 3] 	lda z80_E													
852d : a6b6             [ 3] 	ldx z80_L
852f : 85b6             [ 3] 	sta z80_L
8531 : 86b4             [ 3] 	stx z80_E
8533 : a5b5             [ 3] 	lda z80_D
8535 : a6b7             [ 3] 	ldx z80_H
8537 : 85b7             [ 3] 	sta z80_H
8539 : 86b5             [ 3] 	stx z80_D
853b :                       NOSIG	
853b : 38               [ 2]         sec                            
853c : a5b6             [ 3]         lda z80_L
853e : e5b4             [ 3]         sbc z80_E
8540 : 85b6             [ 3]         sta z80_L
8542 : a5b7             [ 3]         lda z80_H
8544 : e5b5             [ 3]         sbc z80_D
8546 : 85b7             [ 3]         sta z80_H
8548 : 1015             [ 3] 	bpl SET_STP                                     
854a : a5b1             [ 3] 	lda z80_A                                       
854c : 49ff             [ 2]         eor #$FF                                 
854e : a6ba             [ 3]         ldx z80_AP                               
8550 : 85ba             [ 3]         sta z80_AP
8552 : 8a               [ 2]         txa
8553 : 49ff             [ 2] 	eor #$FF                                        
8555 : 18               [ 2]         clc             
8556 : 6901             [ 2]         adc #01                                  
8558 : aa               [ 2]         tax                                      
8559 : a5ba             [ 3]         lda z80_AP
855b : 86ba             [ 3]         stx z80_AP
855d : 85b1             [ 3]         sta z80_A
855f :                       SET_STP	
855f : a018             [ 2]         ldy #(TSlStp+1)                          
8561 : a5b1             [ 3]         lda z80_A
8563 : 91b8             [ 5]         sta (z80_IX),y                           
8565 : aa               [ 2]         tax                                      
8566 : a5ba             [ 3]         lda z80_AP
8568 : 86ba             [ 3]         stx z80_AP
856a : 85b1             [ 3]         sta z80_A
856c : 88               [ 2] 	    dey                       
856d : 91b8             [ 5]         sta (z80_IX),y
856f : a00a             [ 2]         ldy #COnOff                              
8571 : a900             [ 2]         lda #00
8573 : 91b8             [ 5]         sta (z80_IX),y
8575 : 60               [ 6] 	rts                                             
                             
8576 :                       C_GLISS	
8576 : a015             [ 2]         ldy #Flags       											
8578 : b1b8             [ 5] 	lda (z80_IX),y
857a : 0904             [ 2] 	ora #%00000100
857c : 91b8             [ 5] 	sta (z80_IX),y
857e : a000             [ 2] 	ldy #00                 ; lda ($AC,x)	          
8580 : b1b2             [ 5]         lda (z80_C),y
AS65 Assembler for R6502 [1.42].                                     Page   22
---------------------------------- ppt3.asm ----------------------------------

8582 : 85b1             [ 3]         sta z80_A
8584 : e6b2             [ 5]         inc z80_C                                
8586 : d002             [ 3]         bne sy
8588 : e6b3             [ 5]         inc z80_B
858a :                       sy     
858a : a016             [ 2] 	ldy #TnSlDl                                     
858c : 91b8             [ 5]         sta (z80_IX),y
858e : 18               [ 2] 	clc                                             
858f : a5b1             [ 3]         lda z80_A                                
8591 : d00d             [ 3] 	bne GL36                                        
8593 : adfd84           [ 4] 	lda Version+1                                   
8596 : c907             [ 2] 	cmp #7                                          
8598 : b004             [ 3] 	bcs sz                                          
859a : a900             [ 2]         lda #00         ; si A < 7  , A = 0 ($FF+
859c : f002             [ 3]         beq saa
859e : a901             [ 2] sz      lda #01         ; si A >= 7 , A = 1 ($00+
85a0 :                       saa	    
85a0 :                       GL36	
85a0 : a005             [ 2]         ldy #TSlCnt                              
85a2 : 91b8             [ 5] 	sta (z80_IX),y                                  
85a4 : a000             [ 2]         ldy #00                                  
85a6 : b1b2             [ 5]         lda (z80_C),y
85a8 : 85ba             [ 3]         sta z80_AP
85aa : c8               [ 2]         iny
85ab : b1b2             [ 5]         lda (z80_C),y
85ad : 85b1             [ 3]         sta z80_A
85af : 18               [ 2]         clc
85b0 : a5b2             [ 3]         lda z80_C
85b2 : 6902             [ 2]         adc #02
85b4 : 85b2             [ 3]         sta z80_C                                
85b6 : 9002             [ 3]         bcc sac
85b8 : e6b3             [ 5]         inc z80_B
85ba :                       sac     
85ba : 4c5f85           [ 3] 	jmp SET_STP                                     
                             
85bd :                       C_SMPOS	
85bd : a000             [ 2]         ldy #00                  ; lda ($AC,x)	  
85bf : b1b2             [ 5]         lda (z80_C),y
85c1 : e6b2             [ 5]         inc z80_C                                
85c3 : d002             [ 3]         bne sad
85c5 : e6b3             [ 5]         inc z80_B
85c7 :                       sad     
85c7 : a001             [ 2] 	ldy #PsInSm                                     
85c9 : 91b8             [ 5]         sta (z80_IX),y
85cb : 60               [ 6] 	rts                                             
                             
85cc :                       C_ORPOS	
85cc : a000             [ 2]         ldy #00                 ; lda ($AC,x)	   
85ce : b1b2             [ 5]         lda (z80_C),y
85d0 : e6b2             [ 5]         inc z80_C                                
85d2 : d002             [ 3]         bne sae
85d4 : e6b3             [ 5]         inc z80_B
85d6 :                       sae     
85d6 : a000             [ 2] 	ldy #PsInOr                                     
85d8 : 91b8             [ 5]         sta (z80_IX),y
85da : 60               [ 6] 	rts                                             
                                 
85db :                       C_VIBRT	
85db : a000             [ 2]         ldy #00                 ; lda ($AC,x)	   
85dd : b1b2             [ 5]         lda (z80_C),y
85df : e6b2             [ 5]         inc z80_C                                
85e1 : d002             [ 3]         bne saf
AS65 Assembler for R6502 [1.42].                                     Page   23
---------------------------------- ppt3.asm ----------------------------------

85e3 : e6b3             [ 5]         inc z80_B
85e5 :                       saf     
85e5 : a00b             [ 2] 	ldy #OnOffD                                     
85e7 : 91b8             [ 5]         sta (z80_IX),y
85e9 : a00a             [ 2]         ldy #COnOff                              
85eb : 91b8             [ 5]         sta (z80_IX),y
85ed : a000             [ 2] 	ldy #00                 ; lda ($AC,x)	          
85ef : b1b2             [ 5]         lda (z80_C),y
85f1 : e6b2             [ 5]         inc z80_C                                
85f3 : d002             [ 3]         bne sag
85f5 : e6b3             [ 5]         inc z80_B
85f7 : a00c             [ 2] sag     ldy #OffOnD                              
85f9 : 91b8             [ 5]         sta (z80_IX),y
85fb : a900             [ 2]         lda #00                                  
85fd : a005             [ 2]         ldy #TSlCnt                              
85ff : 91b8             [ 5]         sta (z80_IX),y
8601 : a006             [ 2] 	ldy #CrTnSl                                     
8603 : 91b8             [ 5]         sta (z80_IX),y
8605 : c8               [ 2] 	iny                                             
8606 : 91b8             [ 5]         sta (z80_IX),y
8608 : 60               [ 6] 	rts                                             
                             
8609 :                       C_ENGLS	
8609 : a000             [ 2]         ldy #00                                  
860b : b1b2             [ 5]         lda (z80_C),y
860d : 8d8a8b           [ 4]         sta Env_Del+1                            
8610 : 8dc18e           [ 4] 	sta CurEDel
8613 : c8               [ 2]         iny
8614 : b1b2             [ 5]         lda (z80_C),y
8616 : 85b6             [ 3]         sta z80_L                                
8618 : 8d8f8b           [ 4]         sta ESldAdd+1
861b : c8               [ 2]         iny
861c : b1b2             [ 5]         lda (z80_C),y
861e : 85b7             [ 3]         sta z80_H                                
8620 : 8d978b           [ 4] 	sta ESldAdd+9
8623 : 18               [ 2]         clc
8624 : a5b2             [ 3]         lda z80_C 
8626 : 6903             [ 2]         adc #03
8628 : 85b2             [ 3]         sta z80_C
862a : 9002             [ 3]         bcc sah
862c : e6b3             [ 5]         inc z80_B
862e :                       sah	                                             
862e : 60               [ 6] 	rts                                             
                             
862f :                       C_DELAY	
862f : a000             [ 2]         ldy #00                 ; lda ($AC,x)	   
8631 : b1b2             [ 5]         lda (z80_C),y
8633 : e6b2             [ 5]         inc z80_C                                
8635 : d002             [ 3]         bne sak
8637 : e6b3             [ 5]         inc z80_B
8639 :                       sak
8639 : 8dc58a           [ 4] 	sta Delay+1                                     
863c : 60               [ 6] 	rts                                             
                             
863d :                       SETENV	
863d : a014             [ 2]         ldy #Env_En                              
863f : a5b4             [ 3]         lda z80_E
8641 : 91b8             [ 5]         sta (z80_IX),y
8643 : a5b1             [ 3]         lda z80_A                ; OPT (inverser 
8645 : 8dd18e           [ 4]         sta AYREGS+EnvTp
8648 : a000             [ 2] 	ldy #00                                         
864a : b1b2             [ 5]         lda (z80_C),y           
AS65 Assembler for R6502 [1.42].                                     Page   24
---------------------------------- ppt3.asm ----------------------------------

864c : 85b7             [ 3] 	sta z80_H                                       
864e : 8dd38e           [ 4]         sta EnvBase+1                            
8651 : c8               [ 2] 	iny                                             
8652 : b1b2             [ 5]         lda (z80_C),y
8654 : 85b6             [ 3] 	sta z80_L                                       
8656 : 8dd28e           [ 4] 	sta EnvBase
8659 : a5b2             [ 3]         lda z80_C
865b : 18               [ 2]         clc
865c : 6902             [ 2]         adc #02
865e : 85b2             [ 3]         sta z80_C
8660 : 9002             [ 3]         bcc sam
8662 : e6b3             [ 5]         inc z80_B                                
8664 : a900             [ 2] sam	lda #00                                      
8666 : a000             [ 2] 	ldy #PsInOr                                     
8668 : 91b8             [ 5]         sta (z80_IX),y
866a : 8dc18e           [ 4] 	sta CurEDel                                     
866d : 85b7             [ 3] 	sta z80_H                                       
866f : 8dc08e           [ 4]         sta CurESld+1                            
8672 : 85b6             [ 3] 	sta z80_L                                       
8674 : 85b1             [ 3]         sta z80_A
8676 : 8dbf8e           [ 4] 	sta CurESld                                     
8679 :                       C_NOP	
8679 : 60               [ 6]         rts                                      
                             
867a :                       SETORN	
867a : a5b1             [ 3]         lda z80_A
867c : 0a               [ 2]         asl a                                    
867d : 85b4             [ 3] 	sta z80_E                                       
867f : a900             [ 2] 	lda #00             ; OPT (inutile ?)           
8681 : 85b5             [ 3]         sta z80_D
8683 : a000             [ 2] 	ldy #PsInOr                                     
8685 : 91b8             [ 5]         sta (z80_IX),y
8687 :                       OrnPtrs
8687 : a9ac             [ 2] 	    lda #$AC           
8689 : 18               [ 2]         clc
868a : 65b4             [ 3]         adc z80_E                                
868c : 85b6             [ 3]         sta z80_L
868e : a9ac             [ 2]         lda #$AC
8690 : 6900             [ 2]         adc #00
8692 : 85b7             [ 3]         sta z80_H
8694 : a000             [ 2] 	ldy #00                                         
8696 : b1b6             [ 5]         lda (z80_L),y
8698 :                       MDADDR2
8698 : 69ac             [ 2] 	adc #$AC
869a : aa               [ 2]         tax             ; save
869b : c8               [ 2] 	iny                                             
869c : b1b6             [ 5] 	lda (z80_L),y
869e : 69ac             [ 2]         adc #$AC                                 
                             	    
86a0 : a00e             [ 2] 	ldy #OrnPtr+1                                   
86a2 : 91b8             [ 5]         sta (z80_IX),y
86a4 : 88               [ 2]         dey
86a5 : 8a               [ 2] 	txa                                             
86a6 : 91b8             [ 5]         sta (z80_IX),y
86a8 : 60               [ 6] 	rts                                             
                             
                             ;ALL 16 ADDRESSES TO PROTECT FROM BROKEN PT3 MODU
86a9 :                       SPCCOMS 
86a9 : 7886                          fcw C_NOP-1
86ab : 7585                  	fcw C_GLISS-1
86ad : 7984                  	fcw C_PORTM-1
86af : bc85                  	fcw C_SMPOS-1
AS65 Assembler for R6502 [1.42].                                     Page   25
---------------------------------- ppt3.asm ----------------------------------

86b1 : cb85                  	fcw C_ORPOS-1
86b3 : da85                  	fcw C_VIBRT-1
86b5 : 7886                  	fcw C_NOP-1
86b7 : 7886                  	fcw C_NOP-1
86b9 : 0886                  	fcw C_ENGLS-1
86bb : 2e86                  	fcw C_DELAY-1
86bd : 7886                  	fcw C_NOP-1
86bf : 7886                  	fcw C_NOP-1
86c1 : 7886                  	fcw C_NOP-1
86c3 : 7886                  	fcw C_NOP-1
86c5 : 7886                  	fcw C_NOP-1
86c7 : 7886                  	fcw C_NOP-1
                             ; ===============================================
86c9 :                       CHREGS	
86c9 : a900             [ 2]         lda #00                                  
86cb : 85b1             [ 3] 	    sta z80_A       ; save
86cd : 8dce8e           [ 4]         sta Ampl                                 
86d0 : a5b6             [ 3] 	    lda z80_L                                   
86d2 : 85bf             [ 3]         sta val3                                 
86d4 : a5b7             [ 3]         lda z80_H
86d6 : 85c0             [ 3]         sta val3+1
86d8 : a015             [ 2]         ldy #Flags                               
86da : a901             [ 2]         lda #%00000001
86dc : 85bb             [ 3]         sta val1
86de : b1b8             [ 5]         lda (z80_IX),y
86e0 : 24bb             [ 3]         bit val1
86e2 : d003             [ 3] 	    bne saq
86e4 : 4c6089           [ 3]         jmp CH_EXIT                              
86e7 :                       saq     	
                                                                              
86e7 : a00d             [ 2] 	    ldy #OrnPtr                                 
86e9 : b1b8             [ 5]         lda (z80_IX),y
86eb : 85b6             [ 3]         sta z80_L
86ed : 85bb             [ 3]         sta val1            ; save L
86ef : c8               [ 2]         iny                                      
86f0 : b1b8             [ 5]         lda (z80_IX),y
86f2 : 85b7             [ 3]         sta z80_H
86f4 : 85bc             [ 3]         sta val1+1          ; save H
                             	                                                
86f6 : a000             [ 2]         ldy #00
86f8 : b1b6             [ 5]         lda (z80_L),y                            
86fa : 85b4             [ 3]         sta z80_E
86fc : c8               [ 2]         iny
86fd : b1b6             [ 5]         lda (z80_L),y
86ff : 85b5             [ 3]         sta z80_D
8701 : a000             [ 2] 	    ldy #PsInOr                                 
8703 : b1b8             [ 5]         lda (z80_IX),y
8705 : 85b6             [ 3] 	    sta z80_L                                   
8707 : 85b1             [ 3]         sta z80_A                                
8709 : 18               [ 2] 	    clc
870a : a5bb             [ 3]         lda val1
870c : 65b6             [ 3]         adc z80_L
870e : 85b6             [ 3]         sta z80_L
8710 : a5bc             [ 3]         lda val1+1
8712 : 6900             [ 2]         adc #00                
8714 : 85b7             [ 3]         sta z80_H                                
8716 : a5b6             [ 3]         lda z80_L
8718 : 6902             [ 2]         adc #02
871a : 85b6             [ 3]         sta z80_L
871c : a5b7             [ 3]         lda z80_H
871e : 6900             [ 2]         adc #00
8720 : 85b7             [ 3]         sta z80_H
AS65 Assembler for R6502 [1.42].                                     Page   26
---------------------------------- ppt3.asm ----------------------------------

8722 : a5b1             [ 3]         lda z80_A                                
8724 : 6901             [ 2]         adc #01
8726 : c5b5             [ 3]         cmp z80_D                                
8728 : 9003             [ 3] 	    bcc CH_ORPS                                 
872a : 18               [ 2] 	    clc
872b : a5b4             [ 3]         lda z80_E                                
872d :                       CH_ORPS	
872d : a000             [ 2]         ldy #PsInOr                              
872f : 91b8             [ 5]         sta (z80_IX),y
8731 : a012             [ 2] 	    ldy #Note                                   
8733 : b1b8             [ 5]         lda (z80_IX),y
8735 : a000             [ 2] 	    ldy #00                                     
8737 : 71b6             [ 5]         adc (z80_L),y       ; adc ($AC,x)	
8739 : 1002             [ 3] 	    bpl CH_NTP                                  
873b : a900             [ 2] 	    lda #00                                     
873d :                       CH_NTP	
873d : c960             [ 2]         cmp #96                                  
873f : 9002             [ 3] 	    bcc CH_NOK                                  
8741 : a95f             [ 2] 	    lda #95                                     
8743 :                       CH_NOK	
8743 : 0a               [ 2]         asl a                                    
8744 : 85ba             [ 3]         sta z80_AP                               
8746 : a00f             [ 2] 	    ldy #SamPtr                                 
8748 : b1b8             [ 5]         lda (z80_IX),y
874a : 85b6             [ 3]         sta z80_L
874c : 85bb             [ 3] 	    sta val1            ; save L
874e : c8               [ 2]         iny                                      
874f : b1b8             [ 5]         lda (z80_IX),y
8751 : 85b7             [ 3]         sta z80_H
8753 : 85bc             [ 3]         sta val1+1          ; save H
8755 : a000             [ 2] 	    ldy #00
8757 : b1b6             [ 5]         lda (z80_L),y                            
8759 : 85b4             [ 3]         sta z80_E   
875b : c8               [ 2]         iny
875c : b1b6             [ 5]         lda (z80_L),y
875e : 85b5             [ 3]         sta z80_D   
                             
8760 : a001             [ 2] 	    ldy #PsInSm                                 
8762 : b1b8             [ 5]         lda (z80_IX),y
8764 : 85b3             [ 3] 	    sta z80_B                                   
8766 : 0a               [ 2] 	    asl a                                       
8767 : 0a               [ 2] 	    asl a                                       
8768 : 85b6             [ 3] 	    sta z80_L                                   
876a : 18               [ 2]         clc
876b : 65bb             [ 3]         adc val1
876d : 85b6             [ 3]         sta z80_L
876f : a5bc             [ 3]         lda val1+1
8771 : 6900             [ 2]         adc #00
8773 : 85b7             [ 3]         sta z80_H                                
8775 : a5b6             [ 3]         lda z80_L
8777 : 6902             [ 2]         adc #02
8779 : 85b6             [ 3]         sta z80_L
877b : a5b7             [ 3]         lda z80_H
877d : 6900             [ 2]         adc #00
877f : 85b7             [ 3]         sta z80_H
                             
8781 : a5b3             [ 3] 	    lda z80_B                                   
8783 : 6901             [ 2]         adc #01
8785 : c5b5             [ 3] 	    cmp z80_D                                   
8787 : 9002             [ 3] 	    bcc CH_SMPS                                 
8789 : a5b4             [ 3] 	    lda z80_E                                   
878b :                       CH_SMPS	
AS65 Assembler for R6502 [1.42].                                     Page   27
---------------------------------- ppt3.asm ----------------------------------

878b : a001             [ 2]         ldy #PsInSm                              
878d : 91b8             [ 5]         sta (z80_IX),y
878f : a000             [ 2]         ldy #00
8791 : b1b6             [ 5]         lda (z80_L),y                            
8793 : 85b2             [ 3]         sta z80_C
8795 : c8               [ 2]         iny
8796 : b1b6             [ 5]         lda (z80_L),y
8798 : 85b3             [ 3]         sta z80_B
                             
879a : a008             [ 2]         ldy #TnAcc                               
879c : b1b8             [ 5]         lda (z80_IX),y
879e : 85b4             [ 3]         sta z80_E
87a0 : c8               [ 2]         iny
87a1 : b1b8             [ 5]         lda (z80_IX),y
87a3 : 85b5             [ 3] 	    sta z80_D                                   
87a5 : 18               [ 2] 	    clc                                         
87a6 : a002             [ 2]         ldy #02
87a8 : b1b6             [ 5]         lda (z80_L),y                            
87aa : 65b4             [ 3]         adc z80_E
87ac : aa               [ 2]         tax
87ad : c8               [ 2]         iny
87ae : b1b6             [ 5]         lda (z80_L),y
87b0 : 65b5             [ 3]         adc z80_D
87b2 : 85b7             [ 3]         sta z80_H
87b4 : 85b5             [ 3]         sta z80_D
87b6 : 8a               [ 2]         txa
87b7 : 85b6             [ 3]         sta z80_L
87b9 : 85b4             [ 3]         sta z80_E
                             
87bb : a940             [ 2]         lda #%01000000                           
87bd : 24b3             [ 3]         bit z80_B
87bf : f00b             [ 3] 	    beq CH_NOAC                                 
87c1 : a008             [ 2] 	    ldy #TnAcc                                  
87c3 : a5b6             [ 3]         lda z80_L
87c5 : 91b8             [ 5]         sta (z80_IX),y
87c7 : c8               [ 2] 	    iny                                         
87c8 : a5b7             [ 3]         lda z80_H
87ca : 91b8             [ 5]         sta (z80_IX),y
87cc :                       CH_NOAC 												             
87cc : a5ba             [ 3]         lda z80_AP                               
87ce : 85b1             [ 3]         sta z80_A                                
87d0 : 85b6             [ 3]         sta z80_L                                
87d2 : 18               [ 2]         clc
87d3 : a9c4             [ 2]         lda #lo(NT_)
87d5 : 65b6             [ 3]         adc z80_L
87d7 : 85b6             [ 3]         sta z80_L
87d9 : a98f             [ 2]         lda #hi(NT_)
87db : 6900             [ 2]         adc #00
87dd : 85b7             [ 3]         sta z80_H
87df : a000             [ 2]         ldy #00
87e1 : b1b6             [ 5]         lda (z80_L),y                            
87e3 : 65b4             [ 3]         adc z80_E
87e5 : aa               [ 2]         tax
87e6 : c8               [ 2]         iny
87e7 : b1b6             [ 5]         lda (z80_L),y
87e9 : 65b5             [ 3]         adc z80_D                                
87eb : 85b7             [ 3]         sta z80_H
87ed : 8a               [ 2]         txa
87ee : 85b6             [ 3]         sta z80_L
87f0 : 18               [ 2]         clc
87f1 : a006             [ 2] 	    ldy #CrTnSl                                 
87f3 : b1b8             [ 5]         lda (z80_IX),y
AS65 Assembler for R6502 [1.42].                                     Page   28
---------------------------------- ppt3.asm ----------------------------------

87f5 : 85b4             [ 3]         sta z80_E
87f7 : 65b6             [ 3]         adc z80_L
87f9 : 85b6             [ 3]         sta z80_L
87fb : 85bf             [ 3] 	    sta val3
87fd : c8               [ 2]         iny                                      
87fe : b1b8             [ 5]         lda (z80_IX),y
8800 : 85b5             [ 3]         sta z80_D
8802 : 65b7             [ 3]         adc z80_H
8804 : 85b7             [ 3]         sta z80_H
8806 : 85c0             [ 3]         sta val3+1
                             ;CSP_	    
                             	   
8808 : a900             [ 2]         lda #00                                  
880a : a005             [ 2] 	    ldy #TSlCnt                                 
880c : 11b8             [ 5]         ora (z80_IX),y
880e : 85b1             [ 3] 	    sta z80_A
8810 : d003             [ 3]         bne saq1                                 
8812 : 4c9088           [ 3]         jmp CH_AMP
8815 : b1b8             [ 5] saq1	lda (z80_IX),y                              
8817 : 38               [ 2]         sec
8818 : e901             [ 2]         sbc #01
881a : 91b8             [ 5]         sta (z80_IX),y
881c : d072             [ 3] 	    bne CH_AMP                                  
881e : a016             [ 2] 	    ldy #TnSlDl                                 
8820 : b1b8             [ 5]         lda (z80_IX),y
8822 : a005             [ 2]         ldy #TSlCnt                              
8824 : 91b8             [ 5]         sta (z80_IX),y
8826 : 18               [ 2] 	    clc
8827 : a017             [ 2]         ldy #TSlStp                              
8829 : b1b8             [ 5]         lda (z80_IX),y
882b : 65b4             [ 3]         adc z80_E
882d : 85b6             [ 3]         sta z80_L
882f : c8               [ 2] 	    iny                                         
8830 : b1b8             [ 5]         lda (z80_IX),y
8832 : 65b5             [ 3]         adc z80_D
8834 : 85b7             [ 3]         sta z80_H 
8836 : 85b1             [ 3] 	    sta z80_A       ; save                      
8838 : a007             [ 2] 	    ldy #CrTnSl+1                               
883a : 91b8             [ 5]         sta (z80_IX),y
883c : 88               [ 2]         dey                                      
883d : a5b6             [ 3]         lda z80_L
883f : 91b8             [ 5]         sta (z80_IX),y
8841 : a904             [ 2] 	    lda #%00000100                              
8843 : 85bb             [ 3]         sta val1
8845 : a015             [ 2]         ldy #Flags
8847 : b1b8             [ 5]         lda (z80_IX),y
8849 : 24bb             [ 3]         bit val1
884b : d043             [ 3] 	    bne CH_AMP  	                               
884d : a019             [ 2] 	    ldy #TnDelt                                 
884f : b1b8             [ 5]         lda (z80_IX),y
8851 : 85b4             [ 3]         sta z80_E
8853 : c8               [ 2] 	    iny                                         
8854 : b1b8             [ 5]         lda (z80_IX),y
8856 : 85b5             [ 3]         sta z80_D
8858 : a5b1             [ 3] 	lda z80_A                                       
885a : f010             [ 3] 	beq CH_STPP                                     
885c : a5b4             [ 3] 	lda z80_E												
885e : a6b6             [ 3] 	ldx z80_L
8860 : 85b6             [ 3] 	sta z80_L
8862 : 86b4             [ 3] 	stx z80_E
8864 : a5b5             [ 3] 	lda z80_D
8866 : a6b7             [ 3] 	ldx z80_H
AS65 Assembler for R6502 [1.42].                                     Page   29
---------------------------------- ppt3.asm ----------------------------------

8868 : 85b7             [ 3] 	sta z80_H
886a : 86b5             [ 3] 	stx z80_D
886c :                       CH_STPP
886c : 38               [ 2]         sec           ; carry = 0 becoze And A   
886d : a5b6             [ 3]         lda z80_L
886f : e5b4             [ 3]         sbc z80_E
8871 : 85b6             [ 3]         sta z80_L
8873 : a5b7             [ 3]         lda z80_H
8875 : e5b5             [ 3]         sbc z80_D
8877 : 85b7             [ 3]         sta z80_H
8879 : 3015             [ 3]         bmi CH_AMP                               
887b : a013             [ 2] 	ldy #SlToNt                                     
887d : b1b8             [ 5]         lda (z80_IX),y
887f : a012             [ 2] 	ldy #Note                                       
8881 : 91b8             [ 5]         sta (z80_IX),y
8883 : a900             [ 2] 	lda #00                                         
8885 : a005             [ 2] 	ldy #TSlCnt                                     
8887 : 91b8             [ 5]         sta (z80_IX),y
8889 : a006             [ 2] 	ldy #CrTnSl                                     
888b : 91b8             [ 5]         sta (z80_IX),y
888d : c8               [ 2]         iny                                      
888e : 91b8             [ 5]         sta (z80_IX),y
                             
8890 :                       CH_AMP	
8890 : a002             [ 2]         ldy #CrAmSl                              
8892 : b1b8             [ 5]         lda (z80_IX),y
8894 : 85b1             [ 3] 	    sta z80_A       ; save
8896 : a980             [ 2]         lda #%10000000                           
8898 : 24b2             [ 3]         bit z80_C
889a : f021             [ 3] 	    beq CH_NOAM                                 
889c : a940             [ 2] 	    lda #%01000000                              
889e : 24b2             [ 3]         bit z80_C
88a0 : f00c             [ 3] 	    beq CH_AMIN                                 
88a2 : a5b1             [ 3] 	    lda z80_A                                   
88a4 : c90f             [ 2]         cmp #15
88a6 : f015             [ 3] 	    beq CH_NOAM                                 
88a8 : 18               [ 2] 	    clc                                         
88a9 : 6901             [ 2]         adc #01
88ab : 4cb788           [ 3] 	    jmp CH_SVAM                                 
88ae :                       CH_AMIN	
88ae : a5b1             [ 3]         lda z80_A                                
88b0 : c9f1             [ 2]         cmp #$F1            ; -15
88b2 : f009             [ 3] 	    beq CH_NOAM                                 
88b4 : 38               [ 2] 	    sec                                         
88b5 : e901             [ 2]         sbc #01
88b7 :                       CH_SVAM	
88b7 : a002             [ 2]         ldy #CrAmSl                              
88b9 : 91b8             [ 5]         sta (z80_IX),y
88bb : 85b1             [ 3]         sta z80_A
88bd :                       CH_NOAM	
88bd : a5b1             [ 3]         lda z80_A
88bf : 85b6             [ 3]         sta z80_L                                
88c1 : a5b3             [ 3] 	    lda z80_B                                   
88c3 : 290f             [ 2] 	    and #15                                     
88c5 : 18               [ 2] 	    clc                                         
88c6 : 65b6             [ 3]         adc z80_L
88c8 : 1002             [ 3] 	    bpl CH_APOS                                 
88ca : a900             [ 2] 	    lda #00                                     
88cc :                       CH_APOS	
88cc : c910             [ 2]         cmp #16                                  
88ce : 9002             [ 3] 	    bcc CH_VOL                                  
88d0 : a90f             [ 2] 	    lda #15                                     
AS65 Assembler for R6502 [1.42].                                     Page   30
---------------------------------- ppt3.asm ----------------------------------

88d2 :                       CH_VOL	
88d2 : a01c             [ 2]         ldy #Volume                              
88d4 : 11b8             [ 5]         ora (z80_IX),y
88d6 : 85b6             [ 3] 	    sta z80_L
88d8 : 18               [ 2]         clc                                      
88d9 : a9c4             [ 2] 	lda #lo(VT_)                                    
88db : 85b4             [ 3]         sta z80_E
88dd : 65b6             [ 3]         adc z80_L
88df : 85b6             [ 3]         sta z80_L
88e1 : a98e             [ 2]         lda #hi(VT_)
88e3 : 85b5             [ 3]         sta z80_D
88e5 : 6900             [ 2]         adc #00
88e7 : 85b7             [ 3]         sta z80_H
88e9 : a000             [ 2] 	    ldy #00                                     
88eb : b1b6             [ 5]         lda (z80_L),y       ; lda ($AC,x)	
88ed : 85b1             [ 3]         sta z80_A       ; save
88ef :                       CH_ENV	
88ef : a901             [ 2]         lda #%00000001                           
88f1 : 24b2             [ 3]         bit z80_C
88f3 : d008             [ 3] 	    bne CH_NOEN                                 
88f5 : a014             [ 2] 	    ldy #Env_En                                 
88f7 : a5b1             [ 3]         lda z80_A
88f9 : 11b8             [ 5]         ora (z80_IX),y
88fb : 85b1             [ 3]         sta z80_A
                             
88fd :                       CH_NOEN	
88fd : a5b1             [ 3]         lda z80_A
88ff : 8dce8e           [ 4]         sta Ampl                                 
8902 : a5b2             [ 3]         lda z80_C                                
8904 : 85b1             [ 3]         sta z80_A
8906 : a980             [ 2]         lda #%10000000                           
8908 : 24b3             [ 3]         bit z80_B
890a : f034             [ 3] 	    beq NO_ENSL                                 
890c : a5b1             [ 3]         lda z80_A
890e : 2a               [ 2]         rol a                                    
890f : 2a               [ 2] 	    rol a                                       
8910 : c980             [ 2] 	    cmp #$80                                    
8912 : 6a               [ 2]         ror a
8913 : c980             [ 2] 	    cmp #$80                                    
8915 : 6a               [ 2]         ror a
8916 : c980             [ 2] 	    cmp #$80                                    
8918 : 6a               [ 2]         ror a
8919 : a004             [ 2] 	    ldy #CrEnSl                                 
891b : 18               [ 2]         clc
891c : 71b8             [ 5]         adc (z80_IX),y
891e : 85b1             [ 3]         sta z80_A
8920 : a920             [ 2]         lda #%00100000                           
8922 : 24b3             [ 3]         bit z80_B
8924 : f006             [ 3] 	    beq NO_ENAC                                 
8926 : a004             [ 2] 	    ldy #CrEnSl                                 
8928 : a5b1             [ 3]         lda z80_A
892a : 91b8             [ 5]         sta (z80_IX),y
892c :                       NO_ENAC	
892c : a943             [ 2]         lda #lo(AddToEn+1)       ; OPT ?         
892e : 85b6             [ 3]         sta z80_L
8930 : a98b             [ 2]         lda #hi(AddToEn+1)
8932 : 85b7             [ 3]         sta z80_H
8934 : a5b1             [ 3]         lda z80_A
8936 : a000             [ 2]         ldy #00                                  
                             		                                               
8938 : 18               [ 2]         clc
8939 : 71b6             [ 5]         adc (z80_L),y           ; OPT ?
AS65 Assembler for R6502 [1.42].                                     Page   31
---------------------------------- ppt3.asm ----------------------------------

893b : 91b6             [ 5]         sta (z80_L),y                            
893d : 4c5989           [ 3] 	    jmp CH_MIX                                  
8940 :                       NO_ENSL 
8940 : a5b1             [ 3]         lda z80_A
8942 : 6a               [ 2]         ror a                                    
8943 : a003             [ 2] 	    ldy #CrNsSl                                 
8945 : 18               [ 2]         clc
8946 : 71b8             [ 5]         adc (z80_IX),y
8948 : 8dc38e           [ 4] 	    sta AddToNs                                 
894b : 85b1             [ 3]         sta z80_A       ; save
894d : a920             [ 2] 	    lda #%00100000                              
894f : 24b3             [ 3]         bit z80_B
8951 : f006             [ 3] 	    beq CH_MIX                                  
8953 : a003             [ 2] 	    ldy #CrNsSl                                 
8955 : a5b1             [ 3]         lda z80_A
8957 : 91b8             [ 5]         sta (z80_IX),y
8959 :                       CH_MIX	
8959 : a5b3             [ 3]         lda z80_B                                
895b : 6a               [ 2] 	    ror a                                       
895c : 2948             [ 2] 	    and #$48                                    
895e : 85b1             [ 3]         sta z80_A
8960 :                       CH_EXIT	
8960 : a9cb             [ 2]         lda #lo(AYREGS+Mixer)                    
8962 : 85b6             [ 3]         sta z80_L
8964 : a98e             [ 2]         lda #hi(AYREGS+Mixer)
8966 : 85b7             [ 3]         sta z80_H
8968 : a5b1             [ 3] 	    lda z80_A
896a : a000             [ 2]         ldy #00                                  
896c : 11b6             [ 5]         ora (z80_L),y       ; ora ($AC,x)	
896e : 4a               [ 2] 	    lsr a                                       
896f : 9002             [ 3]         bcc saq2
8971 : 0980             [ 2]         ora #$80
8973 : 91b6             [ 5] saq2	sta (z80_L),y                               
8975 : a5c0             [ 3] 	    lda val3+1                                  
8977 : 85b7             [ 3]         sta z80_H
8979 : a5bf             [ 3]         lda val3 
897b : 85b6             [ 3]         sta z80_L
897d : a900             [ 2] 	    lda #00                                     
897f : a00a             [ 2] 	    ldy #COnOff                                 
8981 : 11b8             [ 5]         ora (z80_IX),y
8983 : 85b1             [ 3] 	    sta z80_A       ; save
8985 : d001             [ 3]         bne sas                                  
8987 : 60               [ 6]         rts
8988 : a00a             [ 2] sas 	ldy #COnOff                                 
898a : b1b8             [ 5]         lda (z80_IX),y
898c : 38               [ 2]         sec
898d : e901             [ 2]         sbc #01
898f : 91b8             [ 5]         sta (z80_IX),y
8991 : f001             [ 3] 	    beq sat                                     
8993 : 60               [ 6]         rts
8994 : a015             [ 2] sat 	ldy #Flags                                  
8996 : a5b1             [ 3]         lda z80_A
8998 : 51b8             [ 5]         eor (z80_IX),y                           
899a : 91b8             [ 5]         sta (z80_IX),y                           
899c : 6a               [ 2] 	    ror a                                       
899d : a00b             [ 2] 	    ldy #OnOffD                                 
899f : b1b8             [ 5]         lda (z80_IX),y
89a1 : b004             [ 3] 	    bcs CH_ONDL                                 
89a3 : a00c             [ 2] 	    ldy #OffOnD                                 
89a5 : b1b8             [ 5]         lda (z80_IX),y
89a7 :                       CH_ONDL	
89a7 : a00a             [ 2]         ldy #COnOff                              
AS65 Assembler for R6502 [1.42].                                     Page   32
---------------------------------- ppt3.asm ----------------------------------

89a9 : 91b8             [ 5]         sta (z80_IX),y
89ab : 60               [ 6]         rts                                      
                             ; ===============================================
89ac :                       PLAY    
89ac : a900             [ 2]         lda #00                                  
89ae : 8d438b           [ 4] 	    sta AddToEn+1                               
89b1 : 8dcb8e           [ 4] 	    sta AYREGS+Mixer                            
89b4 : a9ff             [ 2] 	    lda #$FF                                    
89b6 : 8dd18e           [ 4] 	    sta AYREGS+EnvTp                            
89b9 : cebe8e           [ 6] 	    dec DelyCnt                                 
89bc : f003             [ 3] 	    beq sat1                                    
89be : 4cc98a           [ 3]         jmp PL2
89c1 : ce828e           [ 6] sat1	dec ANtSkCn                                 
89c4 : f003             [ 3] 	    beq sat2                                    
89c6 : 4c808a           [ 3]         jmp PL1B
89c9 :                       AdInPtA
89c9 : a901             [ 2] sat2	lda #01                                     
89cb : 85b2             [ 3]         sta z80_C
89cd : a901             [ 2]         lda #01
89cf : 85b3             [ 3]         sta z80_B
89d1 : a000             [ 2] 	    ldy #00                                     
89d3 : b1b2             [ 5]         lda (z80_C),y       ; lda ($AC,x)	       
89d5 : f003             [ 3] 	    beq sat3            ; test 0                
89d7 : 4c6b8a           [ 3]         jmp PL1A
89da : 85b5             [ 3] sat3	sta z80_D                                   
89dc : 8dc28e           [ 4] 	    sta Ns_Base                                 
89df : ad0d80           [ 4] 	    lda CrPsPtr                                 
89e2 : 85b6             [ 3]         sta z80_L
89e4 : ad0e80           [ 4]         lda CrPsPtr+1
89e7 : 85b7             [ 3]         sta z80_H
89e9 : e6b6             [ 5] 	    inc z80_L                                   
89eb : d002             [ 3]         bne sar
89ed : e6b7             [ 5]         inc z80_H
89ef :                       sar                                              
89ef : b1b6             [ 5]         lda (z80_L),y                            
89f1 : 18               [ 2] 	    clc                                         
89f2 : 6901             [ 2]         adc #01
89f4 : 85b1             [ 3]         sta z80_A
89f6 : d014             [ 4]         bne PLNLP                                
89f8 : 202480           [ 6] 	    jsr CHECKLP                                 
89fb :                       LPosPtr
89fb : a9ac             [ 2] 	    lda #$AC                                    
89fd : 85b6             [ 3]         sta z80_L
89ff : a9ac             [ 2]         lda #$AC
8a01 : 85b7             [ 3]         sta z80_H
8a03 : a000             [ 2] 	    ldy #00                 ; OPT ?             
8a05 : b1b6             [ 5]         lda (z80_L),y       ; lda ($AC,x)	       
8a07 : 18               [ 2] 	    clc                                         
8a08 : 6901             [ 2]         adc #01
8a0a : 85b1             [ 3]         sta z80_A           ; save
8a0c :                       PLNLP	
8a0c : a5b6             [ 3]         lda z80_L                                
8a0e : 8d0d80           [ 4]         sta CrPsPtr
8a11 : a5b7             [ 3]         lda z80_H
8a13 : 8d0e80           [ 4]         sta CrPsPtr+1
8a16 : a5b1             [ 3] 	    lda z80_A                                   
8a18 : 38               [ 2]         sec
8a19 : e901             [ 2]         sbc #01
8a1b : 0a               [ 2] 	    asl a                                       
8a1c : 85b4             [ 3] 	    sta z80_E                                   
8a1e : 85b1             [ 3]         sta z80_A
8a20 : 26b5             [ 5] 	    rol z80_D                                   
AS65 Assembler for R6502 [1.42].                                     Page   33
---------------------------------- ppt3.asm ----------------------------------

8a22 :                       PatsPtr
8a22 : a9ac             [ 2] 	    lda #$AC
8a24 : 18               [ 2]         clc
8a25 : 65b4             [ 3]         adc z80_E                                
8a27 : 85b6             [ 3]         sta z80_L
8a29 : a9ac             [ 2]         lda #$AC
8a2b : 65b5             [ 3]         adc z80_D
8a2d : 85b7             [ 3]         sta z80_H
                             	    
8a2f : ad5683           [ 4] 	    lda MODADDR+1                               
8a32 : 85b4             [ 3]         sta z80_E
8a34 : ad5c83           [ 4]         lda MODADDR+7
8a37 : 85b5             [ 3]         sta z80_D
                                                    	                         
8a39 : a000             [ 2] 	    ldy #00                 ; OPT ?
8a3b : b1b6             [ 5]         lda (z80_L),y           ; lda ($AC,x)	   
8a3d : 18               [ 2]         clc                                      
8a3e : 65b4             [ 3]         adc z80_E               ; OPT (adc MODADD
8a40 : 85b2             [ 3]         sta z80_C
8a42 : c8               [ 2]         iny
8a43 : b1b6             [ 5]         lda (z80_L),y
8a45 : 65b5             [ 3]         adc z80_D               ; OPT (adc MODADD
8a47 : 85b3             [ 3]         sta z80_B   
8a49 : c8               [ 2]         iny
8a4a : b1b6             [ 5]         lda (z80_L),y                            
8a4c : 18               [ 2]         clc                     ; OPT ?
8a4d : 65b4             [ 3]         adc z80_E               ; IDEM...
8a4f : 8d8e8a           [ 4]         sta AdInPtB+1   
8a52 : c8               [ 2]         iny
8a53 : b1b6             [ 5]         lda (z80_L),y
8a55 : 65b5             [ 3]         adc z80_D
8a57 : 8d928a           [ 4]         sta AdInPtB+5     
8a5a : c8               [ 2]         iny
8a5b : b1b6             [ 5]         lda (z80_L),y                            
8a5d : 18               [ 2]         clc
8a5e : 65b4             [ 3]         adc z80_E               ; IDEM
8a60 : 8db08a           [ 4]         sta AdInPtC+1   
8a63 : c8               [ 2]         iny
8a64 : b1b6             [ 5]         lda (z80_L),y
8a66 : 65b5             [ 3]         adc z80_D
8a68 : 8db48a           [ 4]         sta AdInPtC+5
                                                                              
8a6b :                       PSP_	
                             
8a6b :                       PL1A	
8a6b : a967             [ 2]         lda #lo(ChanA)                           
8a6d : 85b8             [ 3]         sta z80_IX
8a6f : a98e             [ 2]         lda #hi(ChanA)
8a71 : 85b9             [ 3]         sta z80_IX+1
8a73 : 20c683           [ 6] 	jsr PTDECOD                                     
8a76 : a5b2             [ 3] 	lda z80_C                                       
8a78 : 8dca89           [ 4]         sta AdInPtA+1
8a7b : a5b3             [ 3]         lda z80_B
8a7d : 8dce89           [ 4]         sta AdInPtA+5
                             
8a80 :                       PL1B	
8a80 : ce9f8e           [ 6]         dec BNtSkCn                              
8a83 : d01d             [ 3] 	bne PL1C                                        
8a85 : a984             [ 2] 	lda #lo(ChanB)                                  
8a87 : 85b8             [ 3]         sta z80_IX
8a89 : a98e             [ 2]         lda #hi(ChanB)
8a8b : 85b9             [ 3]         sta z80_IX+1
AS65 Assembler for R6502 [1.42].                                     Page   34
---------------------------------- ppt3.asm ----------------------------------

8a8d :                       AdInPtB
8a8d : a901             [ 2] 	lda #01                                         
8a8f : 85b2             [ 3]         sta z80_C
8a91 : a901             [ 2]         lda #01
8a93 : 85b3             [ 3]         sta z80_B
8a95 : 20c683           [ 6] 	jsr PTDECOD                                     
8a98 : a5b2             [ 3] 	lda z80_C                                       
8a9a : 8d8e8a           [ 4]         sta AdInPtB+1
8a9d : a5b3             [ 3]         lda z80_B
8a9f : 8d928a           [ 4]         sta AdInPtB+5
                             
8aa2 :                       PL1C	
8aa2 : cebc8e           [ 6]         dec CNtSkCn                              
8aa5 : d01d             [ 3] 	bne PL1D                                        
8aa7 : a9a1             [ 2] 	lda #lo(ChanC)                                  
8aa9 : 85b8             [ 3]         sta z80_IX
8aab : a98e             [ 2]         lda #hi(ChanC)
8aad : 85b9             [ 3]         sta z80_IX+1
8aaf :                       AdInPtC
8aaf : a901             [ 2] 	lda #01                                         
8ab1 : 85b2             [ 3]         sta z80_C
8ab3 : a901             [ 2]         lda #01
8ab5 : 85b3             [ 3]         sta z80_B
8ab7 : 20c683           [ 6] 	jsr PTDECOD                                     
8aba : a5b2             [ 3] 	lda z80_C                                       
8abc : 8db08a           [ 4]         sta AdInPtC+1
8abf : a5b3             [ 3]         lda z80_B
8ac1 : 8db48a           [ 4]         sta AdInPtC+5
                             
8ac4 :                       Delay
8ac4 :                       PL1D	
8ac4 : a93e             [ 2]         lda #$3E                                 
8ac6 : 8dbe8e           [ 4] 	    sta DelyCnt                                 
                             
8ac9 :                       PL2	
8ac9 : a967             [ 2]         lda #lo(ChanA)                           
8acb : 85b8             [ 3]         sta z80_IX
8acd : a98e             [ 2]         lda #hi(ChanA)
8acf : 85b9             [ 3]         sta z80_IX+1
8ad1 : adc48e           [ 4] 	    lda AYREGS+TonA                             
8ad4 : 85b6             [ 3]         sta z80_L
8ad6 : adc58e           [ 4]         lda AYREGS+TonA+1
8ad9 : 85b7             [ 3]         sta z80_H
8adb : 20c986           [ 6] 	    jsr CHREGS                                  
8ade : a5b6             [ 3] 	    lda z80_L                                   
8ae0 : 8dc48e           [ 4]         sta AYREGS+TonA
8ae3 : a5b7             [ 3]         lda z80_H
8ae5 : 8dc58e           [ 4]         sta AYREGS+TonA+1
8ae8 : adce8e           [ 4] 	    lda Ampl                                    
8aeb : 8dcc8e           [ 4] 	    sta AYREGS+AmplA                            
                             	
8aee : a984             [ 2]         lda #lo(ChanB)                           
8af0 : 85b8             [ 3]         sta z80_IX
8af2 : a98e             [ 2]         lda #hi(ChanB)
8af4 : 85b9             [ 3]         sta z80_IX+1
8af6 : adc68e           [ 4] 	    lda AYREGS+TonB                             
8af9 : 85b6             [ 3]         sta z80_L
8afb : adc78e           [ 4]         lda AYREGS+TonB+1
8afe : 85b7             [ 3]         sta z80_H
8b00 : 20c986           [ 6] 	    jsr CHREGS                                  
8b03 : a5b6             [ 3] 	    lda z80_L                                   
8b05 : 8dc68e           [ 4]         sta AYREGS+TonB
AS65 Assembler for R6502 [1.42].                                     Page   35
---------------------------------- ppt3.asm ----------------------------------

8b08 : a5b7             [ 3]         lda z80_H
8b0a : 8dc78e           [ 4]         sta AYREGS+TonB+1
8b0d : adce8e           [ 4] 	    lda Ampl                                    
8b10 : 8dcd8e           [ 4] 	    sta AYREGS+AmplB                            
                             	    
8b13 : a9a1             [ 2]         lda #lo(ChanC)                           
8b15 : 85b8             [ 3]         sta z80_IX
8b17 : a98e             [ 2]         lda #hi(ChanC)
8b19 : 85b9             [ 3]         sta z80_IX+1
8b1b : adc88e           [ 4] 	    lda AYREGS+TonC                             
8b1e : 85b6             [ 3]         sta z80_L
8b20 : adc98e           [ 4]         lda AYREGS+TonC+1
8b23 : 85b7             [ 3]         sta z80_H
8b25 : 20c986           [ 6] 	    jsr CHREGS                                  
8b28 : a5b6             [ 3] 	    lda z80_L                                   
8b2a : 8dc88e           [ 4]         sta AYREGS+TonC
8b2d : a5b7             [ 3]         lda z80_H
8b2f : 8dc98e           [ 4]         sta AYREGS+TonC+1
                             
8b32 : adc28e           [ 4] 	    lda Ns_Base_AddToNs                         
8b35 : 85b6             [ 3]         sta z80_L
8b37 : adc38e           [ 4]         lda Ns_Base_AddToNs+1
8b3a : 85b7             [ 3]         sta z80_H                                
8b3c : 18               [ 2] 	    clc                                         
8b3d : 65b6             [ 3]         adc z80_L
8b3f : 8dca8e           [ 4] 	    sta AYREGS+Noise                            
                             
8b42 :                       AddToEn
8b42 : a93e             [ 2] 	    lda #$3E                                    
8b44 : 85b4             [ 3] 	    sta z80_E                                   
8b46 : 0a               [ 2] 	    asl a                                       
8b47 : 9004             [ 3] 	    bcc sau                                     
8b49 : a9ff             [ 2]         lda #$FF
8b4b : d002             [ 3]         bne sau1      ; always
8b4d : a900             [ 2] sau     lda #00
8b4f : 85b5             [ 3] sau1	sta z80_D                                   
8b51 : add38e           [ 4]         lda EnvBase+1
8b54 : 85b7             [ 3]         sta z80_H           ; OPT ?
8b56 : add28e           [ 4]         lda EnvBase                              
8b59 : 85b6             [ 3]         sta z80_L           ; OPT ?
8b5b : 18               [ 2] 	    clc                                         
8b5c : 65b4             [ 3]         adc z80_E
8b5e : 85b6             [ 3]         sta z80_L
8b60 : a5b5             [ 3]         lda z80_D
8b62 : 65b7             [ 3]         adc z80_H           ; OPT ?
8b64 : 85b7             [ 3]         sta z80_H 
8b66 : adc08e           [ 4]         lda CurESld+1
8b69 : 85b5             [ 3]         sta z80_D
8b6b : adbf8e           [ 4]         lda CurESld                              
8b6e : 85b4             [ 3]         sta z80_E
8b70 : 18               [ 2] 	    clc                                         
8b71 : 65b6             [ 3]         adc z80_L
8b73 : 8dcf8e           [ 4]         sta AYREGS+Env                           
8b76 : a5b5             [ 3]         lda z80_D
8b78 : 65b7             [ 3]         adc z80_H
8b7a : 8dd08e           [ 4] 	    sta AYREGS+Env+1                            
                             
8b7d : a900             [ 2]         lda #00                                  
8b7f : 0dc18e           [ 4]         ora CurEDel         ; OPT ?              
8b82 : f019             [ 3] 	    beq ROUT                                    
8b84 : cec18e           [ 6] 	    dec CurEDel                                 
8b87 : d014             [ 3] 	    bne ROUT                                    
AS65 Assembler for R6502 [1.42].                                     Page   36
---------------------------------- ppt3.asm ----------------------------------

8b89 :                       Env_Del
8b89 : a93e             [ 2] 	    lda #$3E                                    
8b8b : 8dc18e           [ 4] 	    sta CurEDel                                 
8b8e :                       ESldAdd
8b8e : a9ac             [ 2] 	    lda #$AC                                    
8b90 : 18               [ 2]         clc
8b91 : 65b4             [ 3]         adc z80_E       
8b93 : 8dbf8e           [ 4]         sta CurESld
8b96 : a9ac             [ 2]         lda #$AC
8b98 : 65b5             [ 3]         adc z80_D
8b9a : 8dc08e           [ 4] 	    sta CurESld+1                               
                             ; ===============================================
                             ; ORIC 1/ATMOS VIA addresses:
030c =                       VIA_PCR = $30C
030f =                       VIA_ORA = $30F
                             ; Values for the PCR register - always enable CB1
00df =                       SND_SELREAD		= 0b11011111		; CB2=low, CA2=high
00fd =                       SND_SELWRITE		= 0b11111101		; CB2=high, CA2=low
00ff =                       SND_SELSETADDR		= 0b11111111		; CB2=high, CA2=hig
00dd =                       SND_DESELECT		= 0b11011101		; CB2=low,CA2=low
8b9d :                       ROUT
8b9d : aec58e           [ 4]         ldx AYREGS+1    ; hi ToneA
8ba0 : adc48e           [ 4]         lda AYREGS+0    ; lo ToneA
8ba3 : 20628d           [ 6]         jsr FIX16BITS
                                     
8ba6 : a900             [ 2]         lda #00             
8ba8 : 8d0f03           [ 4]         sta VIA_ORA     ; register number
8bab : a9ff             [ 2]         lda #SND_SELSETADDR        ; fct: SET PSG
8bad : 8d0c03           [ 4]         sta VIA_PCR
8bb0 : a9dd             [ 2]         lda #SND_DESELECT        ; fct: INACTIVE
8bb2 : 8d0c03           [ 4]         sta VIA_PCR
                             
8bb5 : 8c0f03           [ 4]         sty VIA_ORA
8bb8 : a9fd             [ 2]         lda #SND_SELWRITE        ; fct: WRITE DAT
8bba : 8d0c03           [ 4]         sta VIA_PCR
8bbd : a9dd             [ 2]         lda #SND_DESELECT        ; fct: INACTIVE
8bbf : 8d0c03           [ 4]         sta VIA_PCR
                             
8bc2 : a901             [ 2]         lda #01             
8bc4 : 8d0f03           [ 4]         sta VIA_ORA     ; register number
8bc7 : a9ff             [ 2]         lda #SND_SELSETADDR        ; fct: SET PSG
8bc9 : 8d0c03           [ 4]         sta VIA_PCR
8bcc : a9dd             [ 2]         lda #SND_DESELECT        ; fct: INACTIVE
8bce : 8d0c03           [ 4]         sta VIA_PCR
                             
8bd1 : 8e0f03           [ 4]         stx VIA_ORA
8bd4 : a9fd             [ 2]         lda #SND_SELWRITE        ; fct: WRITE DAT
8bd6 : 8d0c03           [ 4]         sta VIA_PCR
8bd9 : a9dd             [ 2]         lda #SND_DESELECT        ; fct: INACTIVE
8bdb : 8d0c03           [ 4]         sta VIA_PCR
                                     
8bde : aec78e           [ 4]         ldx AYREGS+3    ; hi ToneA
8be1 : adc68e           [ 4]         lda AYREGS+2    ; lo ToneA
8be4 : 20628d           [ 6]         jsr FIX16BITS 
                             
8be7 : a902             [ 2]         lda #02             
8be9 : 8d0f03           [ 4]         sta VIA_ORA     ; register number
8bec : a9ff             [ 2]         lda #SND_SELSETADDR        ; fct: SET PSG
8bee : 8d0c03           [ 4]         sta VIA_PCR
8bf1 : a9dd             [ 2]         lda #SND_DESELECT        ; fct: INACTIVE
8bf3 : 8d0c03           [ 4]         sta VIA_PCR
                             
AS65 Assembler for R6502 [1.42].                                     Page   37
---------------------------------- ppt3.asm ----------------------------------

8bf6 : 8c0f03           [ 4]         sty VIA_ORA
8bf9 : a9fd             [ 2]         lda #SND_SELWRITE        ; fct: WRITE DAT
8bfb : 8d0c03           [ 4]         sta VIA_PCR
8bfe : a9dd             [ 2]         lda #SND_DESELECT        ; fct: INACTIVE
8c00 : 8d0c03           [ 4]         sta VIA_PCR
                             
8c03 : a903             [ 2]         lda #03             
8c05 : 8d0f03           [ 4]         sta VIA_ORA     ; register number
8c08 : a9ff             [ 2]         lda #SND_SELSETADDR        ; fct: SET PSG
8c0a : 8d0c03           [ 4]         sta VIA_PCR
8c0d : a9dd             [ 2]         lda #SND_DESELECT        ; fct: INACTIVE
8c0f : 8d0c03           [ 4]         sta VIA_PCR
                             
8c12 : 8e0f03           [ 4]         stx VIA_ORA
8c15 : a9fd             [ 2]         lda #SND_SELWRITE        ; fct: WRITE DAT
8c17 : 8d0c03           [ 4]         sta VIA_PCR
8c1a : a9dd             [ 2]         lda #SND_DESELECT        ; fct: INACTIVE
8c1c : 8d0c03           [ 4]         sta VIA_PCR
                             
8c1f : aec98e           [ 4]         ldx AYREGS+5    ; hi ToneA
8c22 : adc88e           [ 4]         lda AYREGS+4    ; lo ToneA
8c25 : 20628d           [ 6]         jsr FIX16BITS 
                             
8c28 : a904             [ 2]         lda #04             
8c2a : 8d0f03           [ 4]         sta VIA_ORA     ; register number
8c2d : a9ff             [ 2]         lda #SND_SELSETADDR        ; fct: SET PSG
8c2f : 8d0c03           [ 4]         sta VIA_PCR
8c32 : a9dd             [ 2]         lda #SND_DESELECT        ; fct: INACTIVE
8c34 : 8d0c03           [ 4]         sta VIA_PCR
                             
8c37 : 8c0f03           [ 4]         sty VIA_ORA
8c3a : a9fd             [ 2]         lda #SND_SELWRITE        ; fct: WRITE DAT
8c3c : 8d0c03           [ 4]         sta VIA_PCR
8c3f : a9dd             [ 2]         lda #SND_DESELECT        ; fct: INACTIVE
8c41 : 8d0c03           [ 4]         sta VIA_PCR
                             
8c44 : a905             [ 2]         lda #05             
8c46 : 8d0f03           [ 4]         sta VIA_ORA     ; register number
8c49 : a9ff             [ 2]         lda #SND_SELSETADDR        ; fct: SET PSG
8c4b : 8d0c03           [ 4]         sta VIA_PCR
8c4e : a9dd             [ 2]         lda #SND_DESELECT        ; fct: INACTIVE
8c50 : 8d0c03           [ 4]         sta VIA_PCR
                             
8c53 : 8e0f03           [ 4]         stx VIA_ORA
8c56 : a9fd             [ 2]         lda #SND_SELWRITE        ; fct: WRITE DAT
8c58 : 8d0c03           [ 4]         sta VIA_PCR
8c5b : a9dd             [ 2]         lda #SND_DESELECT        ; fct: INACTIVE
8c5d : 8d0c03           [ 4]         sta VIA_PCR
                             
8c60 : a906             [ 2]         lda #06             
8c62 : 8d0f03           [ 4]         sta VIA_ORA     ; register number
8c65 : a9ff             [ 2]         lda #SND_SELSETADDR        ; fct: SET PSG
8c67 : 8d0c03           [ 4]         sta VIA_PCR
8c6a : a9dd             [ 2]         lda #SND_DESELECT        ; fct: INACTIVE
8c6c : 8d0c03           [ 4]         sta VIA_PCR
                             
8c6f : adca8e           [ 4]         lda AYREGS+6    ; data
                                     ;jsr FIX8BITS
8c72 : 4a               [ 2]         lsr a             ; /2 
8c73 : 8d0f03           [ 4]         sta VIA_ORA
8c76 : a9fd             [ 2]         lda #SND_SELWRITE        ; fct: WRITE DAT
8c78 : 8d0c03           [ 4]         sta VIA_PCR
AS65 Assembler for R6502 [1.42].                                     Page   38
---------------------------------- ppt3.asm ----------------------------------

8c7b : a9dd             [ 2]         lda #SND_DESELECT        ; fct: INACTIVE
8c7d : 8d0c03           [ 4]         sta VIA_PCR
                             
8c80 : a907             [ 2]         lda #07
8c82 : 8d0f03           [ 4]         sta VIA_ORA     ; register number
8c85 : a9ff             [ 2]         lda #SND_SELSETADDR        ; fct: SET PSG
8c87 : 8d0c03           [ 4]         sta VIA_PCR
8c8a : a9dd             [ 2]         lda #SND_DESELECT        ; fct: INACTIVE
8c8c : 8d0c03           [ 4]         sta VIA_PCR
                             
8c8f : adcb8e           [ 4]         lda AYREGS+7    ; data
8c92 : 0940             [ 2]         ora #0x40                ; dflat needs AY
8c94 : 8d0f03           [ 4]         sta VIA_ORA
8c97 : a9fd             [ 2]         lda #SND_SELWRITE        ; fct: WRITE DAT
8c99 : 8d0c03           [ 4]         sta VIA_PCR
8c9c : a9dd             [ 2]         lda #SND_DESELECT        ; fct: INACTIVE
8c9e : 8d0c03           [ 4]         sta VIA_PCR
                             
8ca1 : a908             [ 2]         lda #08             
8ca3 : 8d0f03           [ 4]         sta VIA_ORA     ; register number
8ca6 : a9ff             [ 2]         lda #SND_SELSETADDR        ; fct: SET PSG
8ca8 : 8d0c03           [ 4]         sta VIA_PCR
8cab : a9dd             [ 2]         lda #SND_DESELECT        ; fct: INACTIVE
8cad : 8d0c03           [ 4]         sta VIA_PCR
                             
8cb0 : adcc8e           [ 4]         lda AYREGS+8    ; data
8cb3 : 8d0f03           [ 4]         sta VIA_ORA
8cb6 : a9fd             [ 2]         lda #SND_SELWRITE        ; fct: WRITE DAT
8cb8 : 8d0c03           [ 4]         sta VIA_PCR
8cbb : a9dd             [ 2]         lda #SND_DESELECT        ; fct: INACTIVE
8cbd : 8d0c03           [ 4]         sta VIA_PCR
                             
8cc0 : a909             [ 2]         lda #09             
8cc2 : 8d0f03           [ 4]         sta VIA_ORA     ; register number
8cc5 : a9ff             [ 2]         lda #SND_SELSETADDR        ; fct: SET PSG
8cc7 : 8d0c03           [ 4]         sta VIA_PCR
8cca : a9dd             [ 2]         lda #SND_DESELECT        ; fct: INACTIVE
8ccc : 8d0c03           [ 4]         sta VIA_PCR
                             
8ccf : adcd8e           [ 4]         lda AYREGS+9    ; data
8cd2 : 8d0f03           [ 4]         sta VIA_ORA
8cd5 : a9fd             [ 2]         lda #SND_SELWRITE        ; fct: WRITE DAT
8cd7 : 8d0c03           [ 4]         sta VIA_PCR
8cda : a9dd             [ 2]         lda #SND_DESELECT        ; fct: INACTIVE
8cdc : 8d0c03           [ 4]         sta VIA_PCR
                             
8cdf : a90a             [ 2]         lda #10             
8ce1 : 8d0f03           [ 4]         sta VIA_ORA     ; register number
8ce4 : a9ff             [ 2]         lda #SND_SELSETADDR        ; fct: SET PSG
8ce6 : 8d0c03           [ 4]         sta VIA_PCR
8ce9 : a9dd             [ 2]         lda #SND_DESELECT        ; fct: INACTIVE
8ceb : 8d0c03           [ 4]         sta VIA_PCR
                             
8cee : adce8e           [ 4]         lda AYREGS+10   ; data
8cf1 : 8d0f03           [ 4]         sta VIA_ORA
8cf4 : a9fd             [ 2]         lda #SND_SELWRITE        ; fct: WRITE DAT
8cf6 : 8d0c03           [ 4]         sta VIA_PCR
8cf9 : a9dd             [ 2]         lda #SND_DESELECT        ; fct: INACTIVE
8cfb : 8d0c03           [ 4]         sta VIA_PCR
                             
8cfe : aed08e           [ 4]         ldx AYREGS+12   ; hi Env
8d01 : adcf8e           [ 4]         lda AYREGS+11   ; lo Env
AS65 Assembler for R6502 [1.42].                                     Page   39
---------------------------------- ppt3.asm ----------------------------------

8d04 : 20628d           [ 6]         jsr FIX16BITS 
                             
8d07 : a90b             [ 2]         lda #11             
8d09 : 8d0f03           [ 4]         sta VIA_ORA     ; register number
8d0c : a9ff             [ 2]         lda #SND_SELSETADDR        ; fct: SET PSG
8d0e : 8d0c03           [ 4]         sta VIA_PCR
8d11 : a9dd             [ 2]         lda #SND_DESELECT        ; fct: INACTIVE
8d13 : 8d0c03           [ 4]         sta VIA_PCR
                             
8d16 : 8c0f03           [ 4]         sty VIA_ORA
8d19 : a9fd             [ 2]         lda #SND_SELWRITE        ; fct: WRITE DAT
8d1b : 8d0c03           [ 4]         sta VIA_PCR
8d1e : a9dd             [ 2]         lda #SND_DESELECT        ; fct: INACTIVE
8d20 : 8d0c03           [ 4]         sta VIA_PCR
                             
8d23 : a90c             [ 2]         lda #12             
8d25 : 8d0f03           [ 4]         sta VIA_ORA     ; register number
8d28 : a9ff             [ 2]         lda #SND_SELSETADDR        ; fct: SET PSG
8d2a : 8d0c03           [ 4]         sta VIA_PCR
8d2d : a9dd             [ 2]         lda #SND_DESELECT        ; fct: INACTIVE
8d2f : 8d0c03           [ 4]         sta VIA_PCR
                             
8d32 : 8e0f03           [ 4]         stx VIA_ORA
8d35 : a9fd             [ 2]         lda #SND_SELWRITE        ; fct: WRITE DAT
8d37 : 8d0c03           [ 4]         sta VIA_PCR
8d3a : a9dd             [ 2]         lda #SND_DESELECT        ; fct: INACTIVE
8d3c : 8d0c03           [ 4]         sta VIA_PCR
                             
                                     ; shunte R13 si $FF (Y=13) => plus géné
8d3f : add18e           [ 4]         lda AYREGS+13
8d42 : 1001             [ 3]         bpl OUT_S
8d44 : 60               [ 6]         rts
8d45 : a00d             [ 2] OUT_S   ldy #13
8d47 : 8c0f03           [ 4]         sty VIA_ORA     ; 
8d4a : a0ff             [ 2]         ldy #SND_SELSETADDR        ; fct: SET PSG
8d4c : 8c0c03           [ 4]         sty VIA_PCR
8d4f : a0dd             [ 2]         ldy #SND_DESELECT        ; fct: INACTIVE
8d51 : 8c0c03           [ 4]         sty VIA_PCR
                             
8d54 : 8d0f03           [ 4]         sta VIA_ORA     ; a = data
8d57 : a9fd             [ 2]         lda #SND_SELWRITE        ; fct: WRITE DAT
8d59 : 8d0c03           [ 4]         sta VIA_PCR
8d5c : a9dd             [ 2]         lda #SND_DESELECT        ; fct: INACTIVE
8d5e : 8d0c03           [ 4]         sta VIA_PCR
8d61 : 60               [ 6]         rts
                             ; -------------------------------------
8d62 :                       FIX16BITS       ; INT(256*2*1000/1773) = 289 = 25
                                             ; IN:  register A is low byte
                                             ;      register X is high byte
                                             ; OUT: register Y is low byte
                                             ;      register X is high byte
                             
                                     ; x256
8d62 : 86bb             [ 3]         stx TA1
8d64 : 85bd             [ 3]         sta TB1
8d66 : 86be             [ 3]         stx TB2
8d68 : 85c0             [ 3]         sta TC2
8d6a : 86c1             [ 3]         stx TB3
8d6c : 85c2             [ 3]         sta TC3
8d6e : a900             [ 2]         lda #00
8d70 : 85bc             [ 3]         sta TA2
                                     
AS65 Assembler for R6502 [1.42].                                     Page   40
---------------------------------- ppt3.asm ----------------------------------

                                     ; x32
8d72 : 06c0             [ 5]         asl TC2
8d74 : 26be             [ 5]         rol TB2
8d76 : 26bc             [ 5]         rol TA2
8d78 : 06c0             [ 5]         asl TC2
8d7a : 26be             [ 5]         rol TB2
8d7c : 26bc             [ 5]         rol TA2
8d7e : 06c0             [ 5]         asl TC2
8d80 : 26be             [ 5]         rol TB2
8d82 : 26bc             [ 5]         rol TA2
8d84 : 06c0             [ 5]         asl TC2
8d86 : 26be             [ 5]         rol TB2
8d88 : 26bc             [ 5]         rol TA2
8d8a : 06c0             [ 5]         asl TC2
8d8c : 26be             [ 5]         rol TB2
8d8e : 26bc             [ 5]         rol TA2
                                     
                                     ; x32 + x01
8d90 : 18               [ 2]         clc
8d91 : a5c2             [ 3]         lda TC3
8d93 : 65c0             [ 3]         adc TC2
                                     ; sta TC2
8d95 : a5c1             [ 3]         lda TB3
8d97 : 65be             [ 3]         adc TB2
8d99 : 85be             [ 3]         sta TB2
8d9b : a5bc             [ 3]         lda TA2
8d9d : 6900             [ 2]         adc #00
8d9f : 85bc             [ 3]         sta TA2
                             
                                     ; + x256 
8da1 : 18               [ 2]         clc         
8da2 : a5be             [ 3]         lda TB2
8da4 : 65bd             [ 3]         adc TB1
8da6 : a8               [ 2]         tay         ; sta TB1
8da7 : a5bc             [ 3]         lda TA2
8da9 : 65bb             [ 3]         adc TA1
                                     ; sta TA1
                             
                                     ; / 2 (16bits)
8dab : 4a               [ 2]         lsr a         ; lsr TA1
8dac : aa               [ 2]         tax         ; ldx TA1
8dad : 98               [ 2]         tya         ; lda TB1     
8dae : 6a               [ 2]         ror a         ; ror TB1
8daf : a8               [ 2]         tay         ; ldy TB1
8db0 : 60               [ 6]         rts 
                             
                             ; ===============================================
8db1 :                       NT_DATA	
8db1 : 64                            fcb (T_NEW_0-T1_)*2
8db2 : 2a                    	    fcb TCNEW_0-T_
8db3 : 65                    	    fcb (T_OLD_0-T1_)*2+1
8db4 : 00                    	    fcb TCOLD_0-T_
8db5 : 01                    	    fcb (T_NEW_1-T1_)*2+1
8db6 : 0c                    	    fcb TCNEW_1-T_
8db7 : 01                    	    fcb (T_OLD_1-T1_)*2+1
8db8 : 0c                    	    fcb TCOLD_1-T_
8db9 : 94                    	    fcb (T_NEW_2-T1_)*2
8dba : 35                    	    fcb TCNEW_2-T_
8dbb : 30                    	    fcb (T_OLD_2-T1_)*2
8dbc : 0e                    	    fcb TCOLD_2-T_
8dbd : 60                    	    fcb (T_NEW_3-T1_)*2
8dbe : 20                    	    fcb TCNEW_3-T_
AS65 Assembler for R6502 [1.42].                                     Page   41
---------------------------------- ppt3.asm ----------------------------------

8dbf : 60                    	    fcb (T_OLD_3-T1_)*2
8dc0 : 21                    	    fcb TCOLD_3-T_
                             
8dc1 :                       T_
                             
8dc1 : 0105090b0d0f1315      TCOLD_0	fcb $00+1,$04+1,$08+1,$0A+1,$0C+1,$0E+1,$
8dc9 : 19253d00              	    fcb $18+1,$24+1,$3C+1,0
8dcd : 5d00                  TCOLD_1	fcb $5C+1,0
8dcf : 31374d535f7182..      TCOLD_2	fcb $30+1,$36+1,$4C+1,$52+1,$5E+1,$70+1,$
8dd8 : 9ea0a6a8aaacae..      	    fcb $9E,$A0,$A6,$A8,$AA,$AC,$AE,$AE,0
8de1 : 57                    TCNEW_3	fcb $56+1
8de2 : 1f2325292d2f33..      TCOLD_3	fcb $1E+1,$22+1,$24+1,$28+1,$2C+1,$2E+1,$
8deb : 1d2123272b2d3155      TCNEW_0	fcb $1C+1,$20+1,$22+1,$26+1,$2A+1,$2C+1,$
8df3 : bdbf00                	    fcb $BC+1,$BE+1,0
8dcd =                       TCNEW_1 = TCOLD_1
8df6 : 1b2125292b3b4d5f      TCNEW_2	fcb $1A+1,$20+1,$24+1,$28+1,$2A+1,$3A+1,$
8dfe : bbbdbf00              	    fcb $BA+1,$BC+1,$BE+1,0
                             
8e01 =                       EMPTYSAMORN = *-1
8e02 : 010090                	    fcb 1,0,$90 ;delete #90 if you don't need de
                             
                             ;first 12 values of tone tables
                             
8e05 :                       T1_ 	
8e05 : f01d                          fcw $1DF0
8e07 : 201c                          fcw $1C20
8e09 : c01a                          fcw $1AC0
8e0b : 0019                          fcw $1900
8e0d : b017                          fcw $17B0
8e0f : 5016                          fcw $1650
8e11 : 1015                          fcw $1510
8e13 : e013                          fcw $13E0
                             
8e15 : c012                          fcw $12C0
8e17 : c011                          fcw $11C0
8e19 : b010                          fcw $10B0
8e1b : c00f                          fcw $0FC0
8e1d : 7c1a                          fcw $1A7C
8e1f : 0019                          fcw $1900
8e21 : 9817                          fcw $1798
8e23 : 4416                          fcw $1644
                             
8e25 : 0415                          fcw $1504
8e27 : d813                          fcw $13D8
8e29 : b812                          fcw $12B8
8e2b : ac11                          fcw $11AC
8e2d : b010                          fcw $10B0
8e2f : c00f                          fcw $0FC0
8e31 : dc0e                          fcw $0EDC
8e33 : 080e                          fcw $0E08
                             
8e35 : b419                          fcw $19B4
8e37 : 4418                          fcw $1844
8e39 : e616                          fcw $16E6
8e3b : 9e15                          fcw $159E
8e3d : 6614                          fcw $1466
8e3f : 4213                          fcw $1342
8e41 : 2e12                          fcw $122E
8e43 : 2811                          fcw $1128
                             
8e45 : 3210                          fcw $1032
8e47 : 480f                          fcw $0F48
AS65 Assembler for R6502 [1.42].                                     Page   42
---------------------------------- ppt3.asm ----------------------------------

8e49 : 6e0e                          fcw $0E6E
8e4b : 9e0d                          fcw $0D9E
8e4d : da0c                          fcw $0CDA
8e4f : 201a                          fcw $1A20
8e51 : aa18                          fcw $18AA
8e53 : 4817                          fcw $1748
                             
8e55 : f815                          fcw $15F8
8e57 : be14                          fcw $14BE
8e59 : 9413                          fcw $1394
8e5b : 7a12                          fcw $127A
8e5d : 7011                          fcw $1170
8e5f : 7610                          fcw $1076
8e61 : 8a0f                          fcw $0F8A
8e63 : aa0e                          fcw $0EAA
                             
8e65 : d80d                          fcw $0DD8
                             
8e05 =                       T_OLD_1	= T1_
8e1d =                       T_OLD_2	= T_OLD_1+24
8e35 =                       T_OLD_3	= T_OLD_2+24
8e37 =                       T_OLD_0	= T_OLD_3+2
8e37 =                       T_NEW_0	= T_OLD_0
8e05 =                       T_NEW_1	= T_OLD_1
8e4f =                       T_NEW_2	= T_NEW_0+24
8e35 =                       T_NEW_3	= T_OLD_3
                             
8e67 =                       FILE_END =*
                             ; ===========================
                             
8e67 :                       .bss        ; uninitialized data stuff
                             
                             ;vars from here can be stripped
                             ;you can move VARS to any other address
                             
8e67 :                       VARS
                             ;ChannelsVars
                             
                             ; STRUCT "CHP"
0000 =                       PsInOr	= 0
0001 =                       PsInSm	= 1
0002 =                       CrAmSl  = 2
0003 =                       CrNsSl	= 3
0004 =                       CrEnSl	= 4
0005 =                       TSlCnt	= 5
0006 =                       CrTnSl	= 6
0008 =                       TnAcc	= 8
000a =                       COnOff	= 10
000b =                       OnOffD	= 11
000c =                       OffOnD	= 12
000d =                       OrnPtr	= 13
000f =                       SamPtr	= 15
0011 =                       NNtSkp	= 17
0012 =                       Note	= 18
0013 =                       SlToNt	= 19
0014 =                       Env_En	= 20
0015 =                       Flags	= 21
0016 =                       TnSlDl	= 22
0017 =                       TSlStp	= 23
0019 =                       TnDelt	= 25
001b =                       NtSkCn	= 27
001c =                       Volume	= 28
AS65 Assembler for R6502 [1.42].                                     Page   43
---------------------------------- ppt3.asm ----------------------------------

                             ; end STRUCT
                             
                             ; CHANNEL A
8e67 :                       ChanA	
                             ;reset group
8e67 : 00                    APsInOr	fcb 0
8e68 : 00                    APsInSm	fcb 0
8e69 : 00                    ACrAmSl	fcb 0
8e6a : 00                    ACrNsSl	fcb 0
8e6b : 00                    ACrEnSl	fcb 0
8e6c : 00                    ATSlCnt	fcb 0
8e6d : 0000                  ACrTnSl	fcw 0
8e6f : 0000                  ATnAcc	fcw 0
8e71 : 00                    ACOnOff	fcb 0
                             ;reset group
                             
8e72 : 00                    AOnOffD	fcb 0
                             
8e73 : 00                    AOffOnD	fcb 0
8e74 : 0000                  AOrnPtr	fcw 0
8e76 : 0000                  ASamPtr	fcw 0
8e78 : 00                    ANNtSkp	fcb 0
8e79 : 00                    ANote	fcb 0
8e7a : 00                    ASlToNt	fcb 0
8e7b : 00                    AEnv_En	fcb 0
8e7c : 00                    AFlags	fcb 0
                              ;Enabled - 0,SimpleGliss - 2
8e7d : 00                    ATnSlDl	fcb 0
8e7e : 0000                  ATSlStp	fcw 0
8e80 : 0000                  ATnDelt	fcw 0
8e82 : 00                    ANtSkCn	fcb 0
8e83 : 00                    AVolume	fcb 0
                             	
                             ; CHANNEL B
8e84 :                       ChanB
                             ;reset group
8e84 : 00                    BPsInOr	fcb 0
8e85 : 00                    BPsInSm	fcb 0
8e86 : 00                    BCrAmSl	fcb 0
8e87 : 00                    BCrNsSl	fcb 0
8e88 : 00                    BCrEnSl	fcb 0
8e89 : 00                    BTSlCnt	fcb 0
8e8a : 0000                  BCrTnSl	fcw 0
8e8c : 0000                  BTnAcc	fcw 0
8e8e : 00                    BCOnOff	fcb 0
                             ;reset group
                             
8e8f : 00                    BOnOffD	fcb 0
                             
8e90 : 00                    BOffOnD	fcb 0
8e91 : 0000                  BOrnPtr	fcw 0
8e93 : 0000                  BSamPtr	fcw 0
8e95 : 00                    BNNtSkp	fcb 0
8e96 : 00                    BNote	fcb 0
8e97 : 00                    BSlToNt	fcb 0
8e98 : 00                    BEnv_En	fcb 0
8e99 : 00                    BFlags	fcb 0
                              ;Enabled - 0,SimpleGliss - 2
8e9a : 00                    BTnSlDl	fcb 0
8e9b : 0000                  BTSlStp	fcw 0
8e9d : 0000                  BTnDelt	fcw 0
8e9f : 00                    BNtSkCn	fcb 0
AS65 Assembler for R6502 [1.42].                                     Page   44
---------------------------------- ppt3.asm ----------------------------------

8ea0 : 00                    BVolume	fcb 0
                             
                             ; CHANNEL C
8ea1 :                       ChanC
                             ;reset group
8ea1 : 00                    CPsInOr	fcb 0
8ea2 : 00                    CPsInSm	fcb 0
8ea3 : 00                    CCrAmSl	fcb 0
8ea4 : 00                    CCrNsSl	fcb 0
8ea5 : 00                    CCrEnSl	fcb 0
8ea6 : 00                    CTSlCnt	fcb 0
8ea7 : 0000                  CCrTnSl	fcw 0
8ea9 : 0000                  CTnAcc	fcw 0
8eab : 00                    CCOnOff	fcb 0
                             ;reset group
                             
8eac : 00                    COnOffD	fcb 0
                             
8ead : 00                    COffOnD	fcb 0
8eae : 0000                  COrnPtr	fcw 0
8eb0 : 0000                  CSamPtr	fcw 0
8eb2 : 00                    CNNtSkp	fcb 0
8eb3 : 00                    CNote	fcb 0
8eb4 : 00                    CSlToNt	fcb 0
8eb5 : 00                    CEnv_En	fcb 0
8eb6 : 00                    CFlags	fcb 0
                              ;Enabled - 0,SimpleGliss - 2
8eb7 : 00                    CTnSlDl	fcb 0
8eb8 : 0000                  CTSlStp	fcw 0
8eba : 0000                  CTnDelt	fcw 0
8ebc : 00                    CNtSkCn	fcb 0
8ebd : 00                    CVolume	fcb 0
                             
                             ; ------------
                             
                             ;GlobalVars
8ebe : 00                    DelyCnt	fcb 0
8ebf : 0000                  CurESld	fcw 0
8ec1 : 00                    CurEDel	fcb 0
8ec2 :                       Ns_Base_AddToNs
8ec2 : 00                    Ns_Base	fcb 0
8ec3 : 00                    AddToNs	fcb 0
                             
                             ; ===========================
8ec4 :                       AYREGS ; AY registers
                             
0000 =                       TonA	= 0
0002 =                       TonB	= 2
0004 =                       TonC	= 4
0006 =                       Noise	= 6
0007 =                       Mixer	= 7
0008 =                       AmplA	= 8
0009 =                       AmplB	= 9
000a =                       AmplC	= 10
000b =                       Env	    = 11
000d =                       EnvTp	= 13
                             ; ---
                             
8ece =                       Ampl	= AYREGS+AmplC
                             ; ===========================
8ec4 : 00000000000000..      VT_	ds 256 ;CreatedVolumeTableAddress
                             
AS65 Assembler for R6502 [1.42].                                     Page   45
---------------------------------- ppt3.asm ----------------------------------

8ed2 =                       EnvBase	= VT_+14
8ed4 =                       VAR0END	= VT_+16 ;INIT zeroes from VARS to VAR0EN
                             
                             ; ===========================
8fc4 : 00000000000000..      NT_	ds 192 ;CreatedNoteTableAddress
                             
9084 =                       VARS_END = *
                             
No errors in pass 2.
Wrote binary from address $8000 through $9083.
Total size 4228 bytes.
